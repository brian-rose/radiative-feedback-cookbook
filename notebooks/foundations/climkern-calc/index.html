<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Feedbacks with ClimKern - Radiative Feedback Cookbook</title><meta property="og:title" content="Feedbacks with ClimKern - Radiative Feedback Cookbook"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/radiative-feedback-cookbook/build/ClimKern-logo-a20c73e644259e4ef5ac632daf3ae05d.png"/><meta property="og:image" content="/radiative-feedback-cookbook/build/ClimKern-logo-a20c73e644259e4ef5ac632daf3ae05d.png"/><link rel="stylesheet" href="/radiative-feedback-cookbook/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/radiative-feedback-cookbook/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-T52X8HNYE8"></script><script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-T52X8HNYE8');</script><link rel="icon" href="/radiative-feedback-cookbook/favicon.ico"/><link rel="stylesheet" href="/radiative-feedback-cookbook/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="https://projectpythia.org"><div class="p-1 mr-3"><img src="/radiative-feedback-cookbook/build/pythia_logo-white-rt-39eeac595e9d350be72bf4671d97a787.svg" class="h-9 dark:hidden" height="2.25rem"/><img src="/radiative-feedback-cookbook/build/config-item-84d6d338-d7bc03ca665c8748714f4efdbac698d9.svg" class="hidden h-9 dark:block" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"><div class="relative inline-block mx-2 grow-0"><a href="https://projectpythia.org" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Home</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://foundations.projectpythia.org" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Foundations</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://cookbooks.projectpythia.org/" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Cookbooks</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://projectpythia.org/resource-gallery/" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Resources</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://projectpythia.org/#join-us" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Community</a></div></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="flex text-sm bg-transparent rounded-full focus:outline-none" id="headlessui-menu-button-:Rr4op:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://projectpythia.org" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">Project Pythia</a></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"><a href="https://projectpythia.org" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Home</a><a href="https://foundations.projectpythia.org" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Foundations</a><a href="https://cookbooks.projectpythia.org/" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Cookbooks</a><a href="https://projectpythia.org/resource-gallery/" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Resources</a><a href="https://projectpythia.org/#join-us" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Community</a></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="Radiative Feedback Cookbook" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/radiative-feedback-cookbook/">Radiative Feedback Cookbook</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Preamble" class="block break-words rounded py-2 grow cursor-pointer">Preamble</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Foundations" class="block break-words rounded py-2 grow cursor-pointer">Foundations</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rup8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rup8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div title="Appendix" class="block break-words rounded p-2 my-1 rounded-lg hover:bg-slate-300/30">Appendix</div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap"><main class="article-grid subgrid-gap col-screen"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" class="opacity-50 hover:opacity-100 text-inherit hover:text-inherit" aria-label="Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mx-1"><title>Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)</title><path d="M12 2.2c2.7 0 5 1 7 2.9.9.9 1.6 2 2.1 3.1.5 1.2.7 2.4.7 3.8 0 1.3-.2 2.6-.7 3.8-.5 1.2-1.2 2.2-2.1 3.1-1 .9-2 1.7-3.2 2.2-1.2.5-2.5.7-3.7.7s-2.6-.3-3.8-.8c-1.2-.5-2.2-1.2-3.2-2.1s-1.6-2-2.1-3.2-.8-2.4-.8-3.7c0-1.3.2-2.5.7-3.7S4.2 6 5.1 5.1C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C5.6 7.1 5 8 4.6 9c-.4 1-.6 2-.6 3s.2 2.1.6 3c.4 1 1 1.8 1.8 2.6S8 19 9 19.4c1 .4 2 .6 3 .6s2.1-.2 3-.6c1-.4 1.9-1 2.7-1.8 1.5-1.5 2.3-3.3 2.3-5.6 0-1.1-.2-2.1-.6-3.1-.4-1-1-1.8-1.7-2.6C16.1 4.8 14.2 4 12 4zm-.1 6.4l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.5.3-1 .4-1.5.4-.9 0-1.6-.3-2.1-.8-.5-.6-.8-1.3-.8-2.3 0-.9.3-1.7.8-2.2.6-.6 1.3-.8 2.1-.8 1.2 0 2.1.4 2.6 1.4zm5.6 0l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.4.2-.9.3-1.4.3-.9 0-1.6-.3-2.1-.8s-.8-1.3-.8-2.2c0-.9.3-1.7.8-2.2.5-.5 1.2-.8 2-.8 1.2 0 2.1.4 2.6 1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1"><title>Credit must be given to the creator</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.8c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9-1.8-1.7-2.8-4-2.8-6.7s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.7C16.1 4.8 14.2 4 12 4zm2.6 5.6v4h-1.1v4.7h-3v-4.7H9.4v-4c0-.2.1-.3.2-.4.1-.2.2-.2.4-.2h4c.2 0 .3.1.4.2.2.1.2.2.2.4zm-4-2.5c0-.9.5-1.4 1.4-1.4s1.4.5 1.4 1.4c0 .9-.5 1.4-1.4 1.4s-1.4-.5-1.4-1.4z"></path></svg></a><a href="https://opensource.org/licenses/Apache-2.0" target="_blank" rel="noopener noreferrer" title="Code License: Apache License 2.0 (Apache-2.0)" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mx-1 inline-block opacity-60 hover:opacity-100 hover:text-[#599F46]"><path d="M13.2 15.6c1.4-.5 2.1-1.6 2.1-3.3S13.8 8.9 12 8.9c-1.9 0-3.3 1.6-3.3 3.3 0 1.8.8 3 2.2 3.4l-2.3 5.9c-3.1-.8-6.3-4.6-6.3-9.3 0-5.5 4.3-10 9.7-10s9.8 4.5 9.8 10c0 4.7-3.1 8.5-6.3 9.3l-2.3-5.9z"></path></svg></a><a href="https://en.wikipedia.org/wiki/Open_access" target="_blank" rel="noopener noreferrer" title="Open Access" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mr-1 inline-block opacity-60 hover:opacity-100 hover:text-[#E18435]"><path d="M17.1 12.6h-2V7.5c0-1.7-1.4-3.1-3-3.1-.8 0-1.6.3-2.2.9-.6.5-.9 1.3-.9 2.2v.7H7v-.7c0-1.4.5-2.7 1.5-3.7s2.2-1.5 3.6-1.5 2.6.5 3.6 1.5 1.5 2.3 1.5 3.7v5.1z"></path><path d="M12 21.8c-.8 0-1.6-.2-2.3-.5-.7-.3-1.4-.8-1.9-1.3-.6-.6-1-1.2-1.3-2-.3-.8-.5-1.6-.5-2.4s.2-1.6.5-2.4c.3-.7.7-1.4 1.3-2s1.2-1 1.9-1.3c.7-.3 1.5-.5 2.3-.5.8 0 1.6.2 2.3.5.7.3 1.4.8 1.9 1.3.6.6 1 1.2 1.3 2 .3.8.5 1.6.5 2.4s-.2 1.6-.5 2.4c-.3.7-.7 1.4-1.3 2-.6.6-1.2 1-1.9 1.3-.7.3-1.5.5-2.3.5zm0-10.3c-2.2 0-4 1.8-4 4.1s1.8 4.1 4 4.1 4-1.8 4-4.1-1.8-4.1-4-4.1z"></path><circle cx="12" cy="15.6" r="1.7"></circle></svg></a><a href="https://github.com/projectpythia/radiative-feedback-cookbook" title="GitHub Repository: projectpythia/radiative-feedback-cookbook" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/projectpythia/radiative-feedback-cookbook/blob/main/notebooks/foundations/climkern-calc.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div><button class="inline-flex size-[24px] hover:text-[#E18435] items-center justify-center" aria-label="Launch in external computing interface" title="Launch in external computing interface" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Re8top:" data-state="closed"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.85357 3.85355L7.65355 3.05353C8.2981 2.40901 9.42858 1.96172 10.552 1.80125C11.1056 1.72217 11.6291 1.71725 12.0564 1.78124C12.4987 1.84748 12.7698 1.97696 12.8965 2.10357C13.0231 2.23018 13.1526 2.50125 13.2188 2.94357C13.2828 3.37086 13.2779 3.89439 13.1988 4.44801C13.0383 5.57139 12.591 6.70188 11.9464 7.34645L7.49999 11.7929L6.35354 10.6465C6.15827 10.4512 5.84169 10.4512 5.64643 10.6465C5.45117 10.8417 5.45117 11.1583 5.64643 11.3536L7.14644 12.8536C7.34171 13.0488 7.65829 13.0488 7.85355 12.8536L8.40073 12.3064L9.57124 14.2572C9.65046 14.3893 9.78608 14.4774 9.9389 14.4963C10.0917 14.5151 10.2447 14.4624 10.3535 14.3536L12.3535 12.3536C12.4648 12.2423 12.5172 12.0851 12.495 11.9293L12.0303 8.67679L12.6536 8.05355C13.509 7.19808 14.0117 5.82855 14.1887 4.58943C14.2784 3.9618 14.2891 3.33847 14.2078 2.79546C14.1287 2.26748 13.9519 1.74482 13.6035 1.39645C13.2552 1.04809 12.7325 0.871332 12.2045 0.792264C11.6615 0.710945 11.0382 0.721644 10.4105 0.8113C9.17143 0.988306 7.80189 1.491 6.94644 2.34642L6.32322 2.96968L3.07071 2.50504C2.91492 2.48278 2.75773 2.53517 2.64645 2.64646L0.646451 4.64645C0.537579 4.75533 0.484938 4.90829 0.50375 5.0611C0.522563 5.21391 0.61073 5.34954 0.742757 5.42876L2.69364 6.59928L2.14646 7.14645C2.0527 7.24022 2.00002 7.3674 2.00002 7.50001C2.00002 7.63261 2.0527 7.75979 2.14646 7.85356L3.64647 9.35356C3.84173 9.54883 4.15831 9.54883 4.35357 9.35356C4.54884 9.1583 4.54884 8.84172 4.35357 8.64646L3.20712 7.50001L3.85357 6.85356L6.85357 3.85355ZM10.0993 13.1936L9.12959 11.5775L11.1464 9.56067L11.4697 11.8232L10.0993 13.1936ZM3.42251 5.87041L5.43935 3.85356L3.17678 3.53034L1.80638 4.90074L3.42251 5.87041ZM2.35356 10.3535C2.54882 10.1583 2.54882 9.8417 2.35356 9.64644C2.1583 9.45118 1.84171 9.45118 1.64645 9.64644L0.646451 10.6464C0.451188 10.8417 0.451188 11.1583 0.646451 11.3535C0.841713 11.5488 1.1583 11.5488 1.35356 11.3535L2.35356 10.3535ZM3.85358 11.8536C4.04884 11.6583 4.04885 11.3417 3.85359 11.1465C3.65833 10.9512 3.34175 10.9512 3.14648 11.1465L1.14645 13.1464C0.95119 13.3417 0.951187 13.6583 1.14645 13.8535C1.34171 14.0488 1.65829 14.0488 1.85355 13.8536L3.85358 11.8536ZM5.35356 13.3535C5.54882 13.1583 5.54882 12.8417 5.35356 12.6464C5.1583 12.4512 4.84171 12.4512 4.64645 12.6464L3.64645 13.6464C3.45119 13.8417 3.45119 14.1583 3.64645 14.3535C3.84171 14.5488 4.1583 14.5488 4.35356 14.3535L5.35356 13.3535ZM9.49997 6.74881C10.1897 6.74881 10.7488 6.1897 10.7488 5.5C10.7488 4.8103 10.1897 4.25118 9.49997 4.25118C8.81026 4.25118 8.25115 4.8103 8.25115 5.5C8.25115 6.1897 8.81026 6.74881 9.49997 6.74881Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div><h1 class="mb-0">Feedbacks with ClimKern</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78top:" data-state="closed">Project Pythia Community</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div class="sticky top-[60px] pb-[14px] flex justify-end w-full z-20 pointer-events-none"><div class="flex p-1 m-1 space-x-1 border rounded-full shadow pointer-events-auto border-stone-300 bg-white/80 dark:bg-stone-900/80 backdrop-blur"><div class="rounded"><button class="flex text-center rounded-full cursor-pointer text-stone-800 dark:text-white hover:opacity-100 opacity-60" aria-label="start compute environment"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="inline-block w-6 h-6 align-top"><title>Launch kernel</title><path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"></path></svg></button></div></div></div><div id="skip-to-article"></div><div id="DrckscKi1k" class="relative group/block"><img id="ZHtsL4XnbO" style="width:250px;margin:0 auto" src="/radiative-feedback-cookbook/build/ClimKern-logo-a20c73e644259e4ef5ac632daf3ae05d.png" alt="ClimKern Python Package Logo" data-canonical-url="../images/logos/ClimKern-logo.png" class=""/></div><div id="oQDL8tV8cj" class="relative group/block"><hr class="py-2 my-5 translate-y-2"/></div><div id="G1tdLJvxxw" class="relative group/block"><h2 id="overview" class="relative group"><span class="heading-text">Overview</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#overview" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>While it is good to know how to manually calculate radiative feedbacks, it is also time-consuming to constantly recreate the code. Here, we will use a Python package called ClimKern <span class="cite-group parenthetical"><cite class="" data-state="closed"><a href="https://doi.org/10.5194/gmd-18-3065-2025" target="_blank" rel="noreferrer" class="hover-link">Janoski <em>et al.</em>, 2025</a></cite></span> that offers functions to calculate radiative feedbacks from climate model or reanalysis output. The advantages of using ClimKern go beyond making it simpler—it standardizes the methods and assumptions that go into these sometimes complicated calculations. We will use CMIP6 output in this notebook. You will learn how to:</p><ol start="1"><li>Download CMIP6 data from Pangeo’s space on Google Cloud.</li><li>Obtain a radiative kernel from the ClimKern repository.</li><li>Calculate the surface albedo, temperature, and water vapor feedbacks.</li><li>Compute the cloud feedbacks using the two main methods: residual and adjustment.</li><li>Quantify stratospheric feedbacks.</li></ol></div><div id="AfKFpOaAhF" class="relative group/block"><h2 id="prerequisites" class="relative group"><span class="heading-text">Prerequisites</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#prerequisites" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><table class=""><tbody><tr class=""><th class="">Concepts</th><th class="">Importance</th><th class="">Notes</th></tr><tr class=""><td class=""><a target="_blank" rel="noreferrer" href="https://foundations.projectpythia.org/core/xarray/xarray-intro" class="">Intro to Xarray</a></td><td class="">Necessary</td><td class=""></td></tr><tr class=""><td class=""><a target="_blank" rel="noreferrer" href="https://foundations.projectpythia.org/core/cartopy/cartopy" class="">Intro to Cartopy</a></td><td class="">Necessary</td><td class=""></td></tr><tr class=""><td class=""><a target="_blank" rel="noreferrer" href="https://foundations.projectpythia.org/core/matplotlib/matplotlib-basics" class="">Intro to Matplotlib</a></td><td class="">Helpful</td><td class=""></td></tr><tr class=""><td class=""><a target="_blank" rel="noreferrer" href="https://projectpythia.org/cmip6-cookbook/notebooks/foundations/intake-esm" class="">Loading CMIP6 Data with Intake-ESM</a></td><td class="">Helpful</td><td class=""></td></tr></tbody></table><ul><li><strong>Time to learn</strong>: 20 minutes</li></ul></div><div id="wZKeOrmjj6" class="relative group/block"><hr class="py-2 my-5 translate-y-2"/></div><div id="wck7bbQTDO" class="relative group/block"><h2 id="imports" class="relative group"><span class="heading-text">Imports</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#imports" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="gLxCUbDK64" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import climkern as ck
import intake
import matplotlib.pyplot as plt
import s3fs
import fsspec
import xarray as xr
import glob
import importlib.util
import os
import cartopy.crs as ccrs

%matplotlib inline
plt.rcParams[&quot;figure.dpi&quot;] = 100</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="XpvczVE6dFBtzrfrAQ8sn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="c4RkNfx3tI" class="relative group/block"><h2 id="download-the-kernel" class="relative group"><span class="heading-text">Download the kernel</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#download-the-kernel" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="NgE9xpxMdM" class="relative group/block"><p>Normally, when ClimKern is installed, the user needs to download data on the command
line from the Zenodo repository. However, we now have the data on Jetstream2, so
we can download it from there and save it in our package repository.</p><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Note</div></div><div class="myst-admonition-body px-4 py-1"><p>Future versions of ClimKern will be able to pull the kernel from Jetstream2 without storing locally.</p></div></aside><p>First, set the URL and path to point to ClimKern. Also, specify which kernel you want.</p></div><div id="duoDsIxOvG" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">URL = &quot;https://js2.jetstream-cloud.org:8001/&quot; # URL for jetstream access
path = f&quot;pythia/ClimKern&quot; # Location of ClimKern
kernel = &quot;ERA5&quot;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="3WsPHaridxZS2740ejM53" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="LJ8HT3CZcD" class="relative group/block"><p>Next, read in the data from Jetstream2</p></div><div id="HGbnaVXVZI" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Read in data
# Set up access to jetstream2
fs = fsspec.filesystem(&quot;s3&quot;, anon=True, client_kwargs=dict(endpoint_url=URL))
pattern = f&quot;s3://{path}/kernels/&quot;+kernel+f&quot;/TOA*.nc&quot;

# Grab the data
files = sorted(fs.glob(pattern))
fs.invalidate_cache() # This is necessary to deal with peculiarities of objects served from jetstream2

# Open file and make it Xarray Dataset
kern = xr.open_dataset(fs.open(files[0]))

# Save path for later
path_out = files[0].split(kernel+&quot;/&quot;,1)[1]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="QdtJ8yEjqlE_NPU_Rj4NW" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="tRCfdqIarF" class="relative group/block"><p>To save this data in ClimKern’s directory, we have to figure out where it is on the
machine. After that, we will go ahead and save out the kernel as a netCDF in
ClimKern’s local data directory.</p></div><div id="tYlamczhmx" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Get the package location
spec = importlib.util.find_spec(&quot;climkern&quot;)
package_dir = os.path.dirname(spec.origin)

# print(f&quot;The package directory is: {package_dir}&quot;)

# Define the path where you want to save the netCDF file within the package directory
netcdf_path = os.path.join(package_dir,&quot;data/kernels&quot;,kernel,path_out)

# Ensure the directory exists
os.makedirs(os.path.dirname(netcdf_path), exist_ok=True)

# Save the dataset as a netCDF file
kern.to_netcdf(netcdf_path)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="IHIeXHn3ShyLbgXhpebxE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ktC6d9wi7I" class="relative group/block"><p>Now, let’s just make sure we can retrieve the kernel.</p></div><div id="svU6YzIkUy" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ck.util.get_kern(kernel)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="qzn5xovWU9mAqI-wBJg3C" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="ji8L55Y37t" class="relative group/block"><h2 id="prepare-the-cmip6-data" class="relative group"><span class="heading-text">Prepare the CMIP6 Data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#prepare-the-cmip6-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="QTawOwAuv6" class="relative group/block"><p>To start, we will need some CMIP6 data to calculate feedbacks. We will use the
preindustrial control and 4×CO<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4511em;vertical-align:-0.15em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> experiments from just one model (CESM2).</p></div><div id="Q6TeHQFa0b" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Make a list of variables and experiments we need
var_list = [&quot;rsds&quot;,&quot;rsus&quot;,&quot;ta&quot;,&quot;ts&quot;,&quot;ps&quot;,&quot;hus&quot;]
exp_list = [&quot;piControl&quot;,&quot;abrupt-4xCO2&quot;]

# Specify data location, open it
cat_url = &quot;https://storage.googleapis.com/cmip6/pangeo-cmip6.json&quot;
col = intake.open_esm_datastore(cat_url)

# Create a catalog of matching simulations
cat = col.search(experiment_id=exp_list,source_id=&quot;CESM2&quot;,variable_id=var_list,
                table_id=&quot;Amon&quot;)

# Convert to a dictionary of Xarray Datasets
ds_dict = cat.to_dataset_dict(zarr_kwargs={&#x27;consolidated&#x27;: True})</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Mk9U8fL-JqhYg3sSrVKvw" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="jZcZxZaNo7" class="relative group/block"><p>The data, especially the preindustrial control simulation that will serve as our
control climate, is huge. We are going to only use the last 50 years of the control
and last 30 years of the abrupt 4×CO<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4511em;vertical-align:-0.15em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> simulation. There are a few extra coordinates
and/or dimensions we don’t need, hence the <code>squeeze()</code>.</p></div><div id="Q8n7lzgrDz" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Our control simulation
ctrl = ds_dict[&quot;CMIP.NCAR.CESM2.piControl.Amon.gn&quot;].isel(
    time=slice(-600,None)).squeeze().compute()

# The increase CO2 aka &quot;perturbed&quot; simulation
pert = ds_dict[&quot;CMIP.NCAR.CESM2.abrupt-4xCO2.Amon.gn&quot;].isel(
    time=slice(-360,None)).squeeze().compute()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="cs6MtzltE3wKjkGEBRc7v" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="soB1ALBcE7" class="relative group/block"><p>To save a little diskspace because ClimKern still isn’t dask compatible yet,
let’s make our control climatology ahead of time.</p></div><div id="PO5NrZYOLq" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ctrl = ctrl.groupby(ctrl.time.dt.month).mean(dim=&quot;time&quot;).rename({&quot;month&quot;:&quot;time&quot;})
pert = pert.groupby(pert.time.dt.month).mean(dim=&quot;time&quot;).rename({&quot;month&quot;:&quot;time&quot;})</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="pNv1F8Id7bLZk7wszUb4S" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="HZ7KPhEmT2" class="relative group/block"><h2 id="feedback-calculations" class="relative group"><span class="heading-text">Feedback calculations</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#feedback-calculations" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="T0x8qnWCib" class="relative group/block"><h3 id="calculate-surface-temperature-change" class="relative group"><span class="heading-text">Calculate surface temperature change</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#calculate-surface-temperature-change" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="HBEJpkElMf" class="relative group/block"><p>ClimKern outputs feedbacks as radiative perturbations at the TOA (because there are multiple ways to quantify feedbacks). One of the most common ways is to normalize by the change in the surface temperature, which puts values in “true” feedback units of W/m<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>/K. For that, we start by calculating the change in the surface temperature in our CESM2 experiment.</p></div><div id="gLgRtSHpZZ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Take difference between pert and ctrl ts fields
Δts = pert.ts - ctrl.ts</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7HCFIfdBvKJ3u3bu2a1Aw" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Qu009LLRZB" class="relative group/block"><h3 id="surface-albedo-feedback" class="relative group"><span class="heading-text">Surface albedo feedback</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#surface-albedo-feedback" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="MpeY78exvZ" class="relative group/block"><p>Perhaps the simplest of the radiative feedbacks to calculate is the surface albedo
feedback because it requires only two variables and is a 3-dimensional field (no height
coordinate). The variables we will use are as follows:</p><table class=""><tbody><tr class=""><th class="">Variable name</th><th class="">Description</th><th class="">Units</th></tr><tr class=""><td class=""><em>rsus</em></td><td class="">The upwelling shortwave radiation at the surface</td><td class="">W/m<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></td></tr><tr class=""><td class=""><em>rsds</em></td><td class="">The downwelling shortwave radiation at the surface</td><td class="">W/m<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></td></tr></tbody></table><p>The <a target="_blank" rel="noreferrer" href="https://tyfolino.github.io/climkern/climkern.html#climkern.calc_alb_feedback" class=""><code>calc_alb_feedback()</code></a> function is straightforward. Be sure to include our kernel name
in the arguments.</p></div><div id="UFpcCD1Eop" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">alb = ck.calc_alb_feedback(
    ctrl.rsus,ctrl.rsds,pert.rsus,pert.rsds,kern=&quot;ERA5&quot;
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gfpaa2SDYosyfX40dpuLa" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="K8IOghqMIM" class="relative group/block"><p>Let’s see what the resulting Dataarray looks like.</p></div><div id="nsqYdxCCta" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">alb</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="yQEktPYu23fTCaH0CciRm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="W6T2yiK02O" class="relative group/block"><p>This function allows for the quick creation of a pre-configured map, eliminating the need to repeat setup code by setting up the figure, axes, and Cartopy Robinson projection.</p></div><div id="FJ6E6CulP5" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def base_map():
    proj= ccrs.Robinson()  #select Robinson projection

    fig, ax = plt.subplots(subplot_kw=dict(projection=proj)) #Create the figure and axis 
 
    ax.coastlines() # Add coastlines

    return fig, ax

</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8I4kiiI1wYAuyH9iU0ZgI" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="D815ZBASkn" class="relative group/block"><p>Similar to the function above, these dictionaries encapsulate the repetitive code setup and provide a set of reusable arguments to simplify the plotting of data onto this map.</p></div><div id="k47q9hy4Iy" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">plotargs = {&#x27;transform&#x27;: ccrs.PlateCarree(),
            &#x27;cbar_kwargs&#x27;: {&quot;orientation&quot;: &quot;horizontal&quot;, &quot;shrink&quot;: 0.7, 
                            &quot;label&quot;:&quot;W/m$^2$&quot;}
            }</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tw2P0GVA-EAjlymdOgI8g" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="vo8Yjbl9m1" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">plotargs_2 = {&#x27;transform&#x27;: ccrs.PlateCarree(),
            &#x27;cbar_kwargs&#x27;: {&quot;orientation&quot;: &quot;horizontal&quot;, &quot;shrink&quot;: 0.7,
                           &quot;label&quot;:&quot;W/m$^2$/K&quot;}
            }</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="73IiA40ScNdIaD9jb_I9x" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="lNUVBJbTAz" class="relative group/block"><p>Finally, let’s plot the time average surface albedo feedback on a map, first as just the perturbation.</p></div><div id="dApwK79mKg" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create the base map
fig, ax = base_map()

# Plot the surface albedo feedback 
alb.mean(dim=&quot;time&quot;).plot(ax=ax, **plotargs)

# Add a title
ax.set_title(&quot;Time-averaged Surface Albedo Feedback&quot;);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Dj6SnICPwaVwHqCa_H4JB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/110m_physical/ne_110m_coastline.zip
</span></code></pre></div><img src="/radiative-feedback-cookbook/build/d49c5a85865467e6a8d176e03d6c531b.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="Vv547DoZqs" class="relative group/block"><p>Now normalized by the surface temperature change...</p></div><div id="hk04Z8iTVz" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create the base map
fig, ax = base_map()

# Plot surface albedo feedback &amp; add coastlines
(alb.mean(dim=&quot;time&quot;)/Δts.mean(dim=&quot;time&quot;)).plot(ax=ax, **plotargs_2)

# Add a title
ax.set_title(&quot;Time-averaged Surface Albedo Feedback&quot;);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Mrf9_PMWLp0mQBTIkMccm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/radiative-feedback-cookbook/build/7b8c2f61d3281cbd310da6a5c49c6e43.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="ZMvBLVumW8" class="relative group/block"><p>As one might expect, the greatest radiative change at the TOA from the surface albedo feedback is near the poles where there is melting sea ice and snow.</p><p>Let’s end by calculating the global average. ClimKern comes with a <a target="_blank" rel="noreferrer" href="https://tyfolino.github.io/climkern/climkern.html#climkern.spat_avg" class=""><code>spat_avg()</code></a> function.</p></div><div id="kIlUUNfkVE" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Output the time-averaged global surface albedo feedback
output = &quot;The global average surface albedo feedback is {value:.2f} W/m\u00b2/K.&quot;
print(output.format(value=float(ck.spat_avg((alb.mean(dim=&quot;time&quot;)/Δts.mean(dim=&quot;time&quot;)
                                         ).expand_dims(&quot;time&quot;)))))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="un7dBQgFzzMzRnMTiJwKS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>The global average surface albedo feedback is 0.23 W/m²/K.
</span></code></pre></div></div></div><div id="MVwwbrNzL0" class="relative group/block"><h3 id="planck-and-lapse-rate-feedbacks" class="relative group"><span class="heading-text">Planck and lapse rate feedbacks</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#planck-and-lapse-rate-feedbacks" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="pKpc1iTqFg" class="relative group/block"><p>As a reminder, the total tropospheric temperature feedback is often decomposed into a distict Planck and lapse rate feedback. ClimKern has a single function that produces both feedbacks simultaneously called <a target="_blank" rel="noreferrer" href="https://tyfolino.github.io/climkern/climkern.html#climkern.calc_T_feedbacks" class=""><code>calc_T_feedbacks()</code></a>. The variables we need this time are:</p><table class=""><tbody><tr class=""><th class="">Variable name</th><th class="">Description</th><th class="">Units</th><th class="">Notes</th></tr><tr class=""><td class=""><em>ta</em></td><td class="">The 4-dimensional air temperature</td><td class="">K</td><td class=""></td></tr><tr class=""><td class=""><em>ts</em></td><td class="">The 3-dimensional surface skin temperature</td><td class="">K</td><td class=""></td></tr><tr class=""><td class=""><em>ps</em></td><td class="">The 3-dimensional surface pressure</td><td class="">Pa, mb, or hPa</td><td class=""></td></tr><tr class=""><td class=""><em>trop_p</em></td><td class="">The 3-dimensional tropopause height</td><td class="">Pa, mb, or hPa</td><td class=""><em>Optional</em></td></tr></tbody></table><p>CMIP6 output rarely contains the tropopause height, so we will create a default tropopause that decreases linearly with the cosine of latitude from 100 hPa at the Equator to 300 hPa at the poles.</p></div><div id="z8fe3AsCJI" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Use ClimKern&#x27;s &quot;hidden&quot; make_tropo function
pert[&quot;trop_p&quot;] = ck.util.make_tropo(pert.ps)
pert.trop_p.attrs[&quot;units&quot;] = &quot;Pa&quot;

lr,pl = ck.calc_T_feedbacks(
    ctrl.ta,ctrl.ts,ctrl.ps,pert.ta,pert.ts,pert.ps,pert_trop=pert.trop_p,kern=&quot;ERA5&quot;
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="btus8a0rEzY3GWocHI4aW" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="wQbz0W1v0h" class="relative group/block"><p>Simple. Let’s see what it looks like.</p></div><div id="dg2EQyTz3N" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create the base map
fig, ax = base_map()

# Plot the surface albedo feedback 
lr.mean(dim=&quot;time&quot;).plot(ax=ax, **plotargs)

# Add a title
ax.set_title(&quot;Time-averaged Lapse Rate Feedback&quot;);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="sgF4VdancnHHFPvjRBWWs" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/radiative-feedback-cookbook/build/b1bca7c41dad2b96a67a2230f4962f88.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="exgEFXycQg" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create the base map
fig, ax = base_map()

# Plot surface albedo feedback
(lr.mean(dim=&quot;time&quot;)/Δts.mean(dim=&quot;time&quot;)).plot(ax=ax, **plotargs_2)

# Add a title
ax.set_title(&quot;Time-averaged Lapse Rate Feedback&quot;);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="yc2lHvMr9RRpkpR_XKVlU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/radiative-feedback-cookbook/build/c23fe85703792f4cae1893a83bbda153.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="P19WHytxuE" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create the base map
fig, ax = base_map()

# Plot surface albedo feedback
pl.mean(dim=&quot;time&quot;).plot(ax=ax, cmap=&quot;Blues_r&quot;, **plotargs)

# Add a title
ax.set_title(&quot;Time-averaged Planck Feedback&quot;);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4jhRbEQf6QS6stbhRDFI6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/radiative-feedback-cookbook/build/766fb39e268ce8a167bc40f9e55001d1.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="onn3KfZIIv" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create the base map
fig, ax = base_map()

# Plot surface albedo feedback
(pl.mean(dim=&quot;time&quot;)/Δts.mean(dim=&quot;time&quot;)).plot(ax=ax,cmap=&quot;Blues_r&quot;, **plotargs_2)

# Add a title
ax.set_title(&quot;Time-averaged Planck Feedback&quot;);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HNY72Q2Z-0NJoEE-wD0jP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/radiative-feedback-cookbook/build/00fd5e2de358c4012f44dddb899e25c9.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="g5HmTyd8yZ" class="relative group/block"><p>These results seem reasonable. The Planck feedback is often the feedback with the largest magnitude and scales nonlinearly with temperature change. The lapse rate feedback changes sign depending on the vertical structure of the atmosphere is usually positive (warming) at the poles and negative (cooling) in the tropics.</p><p>Let’s get those global averages again!</p></div><div id="xZk2Mn1it2" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Output the time-averaged global temperature feedbacks
output = (&quot;The global average lapse rate and Planck feedbacks are&quot;+
          &quot; {lr:.2f} and {pl:.2f} W/m\u00b2/K, respectively.&quot;)
print(output.format(lr=float(ck.spat_avg((lr.mean(dim=&quot;time&quot;)/Δts.mean(dim=&quot;time&quot;)
                                         ).expand_dims(&quot;time&quot;))),
                   pl=float(ck.spat_avg((pl.mean(dim=&quot;time&quot;)/Δts.mean(dim=&quot;time&quot;)
                                        ).expand_dims(&quot;time&quot;)))))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="de-R-H9E92AF6ztej91CR" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>The global average lapse rate and Planck feedbacks are -0.78 and -3.33 W/m²/K, respectively.
</span></code></pre></div></div></div><div id="wDRJWLbHX4" class="relative group/block"><h3 id="water-vapor-feedbacks" class="relative group"><span class="heading-text">Water vapor feedbacks</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#water-vapor-feedbacks" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="iAa4QtKo0I" class="relative group/block"><p>Here we use ClimKern to calculate the longwave and shortwave water vapor feedabcks. ClimKern has a single function that produces both called <a target="_blank" rel="noreferrer" href="https://tyfolino.github.io/climkern/climkern.html#climkern.calc_q_feedbacks" class=""><code>calc_q_feedbacks()</code></a>. This function requires both the specific humidity and air temperature because ClimKern has to normalize the water vapor kernels to make them compatible with the specific humidity.</p><table class=""><tbody><tr class=""><th class="">Variable name</th><th class="">Description</th><th class="">Units</th><th class="">Notes</th></tr><tr class=""><td class=""><em>hus</em></td><td class="">The 4-dimensional specific humidity</td><td class=""><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>g</mi><mi>g</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{g}{g}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2286em;vertical-align:-0.4811em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> or <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>g</mi><mrow><mi>k</mi><mi>g</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{g}{kg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2286em;vertical-align:-0.4811em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></td><td class=""></td></tr><tr class=""><td class=""><em>ta</em></td><td class="">The 4-dimensional air temperature</td><td class="">K</td><td class=""></td></tr><tr class=""><td class=""><em>ps</em></td><td class="">The 3-dimensional surface pressure</td><td class="">Pa, mb, or hPa</td><td class=""></td></tr><tr class=""><td class=""><em>trop_p</em></td><td class="">The 3-dimensional tropopause height</td><td class="">Pa, mb, or hPa</td><td class=""><em>Optional</em></td></tr></tbody></table><p>There is one more argument we can provide called <code>method</code>, which is simply a number 1-4. This corresponds to whether to use a fractional approximation for logarithms, use the logarithms explicitly, or use the linear change in water vapor concentration. See the discussion in Section 3.2 of <span class="cite-group narrative"><cite class="" data-state="closed"><a href="https://doi.org/10.5194/gmd-18-3065-2025" target="_blank" rel="noreferrer" class="hover-link">Janoski <em>et al.</em> (2025)</a></cite></span>, and see <a target="_blank" rel="noreferrer" href="https://tyfolino.github.io/climkern/climkern.html#climkern.calc_q_feedbacks" class="">here in the climkern docs</a> for how these are implemented.</p><p>We will use <code>method=1</code> which is to use the natural logarithm of specific humidity without doing a fractional approximation.</p><p>We will use the same tropopause height as before.</p></div><div id="RmfuV06A6e" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Use ClimKern&#x27;s water vapor feedback function
qlw,qsw = ck.calc_q_feedbacks(
    ctrl.hus,ctrl.ta,ctrl.ps,pert.hus,pert.ps,pert_trop=pert.trop_p,kern=&quot;ERA5&quot;,
    method=1
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="fLQxweqqQg_HZbwdQLeg_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="E25oDJjE8h" class="relative group/block"><p>Let’s take a look, starting with the longwave.</p></div><div id="FzmotykS74" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create the base map
fig, ax = base_map()

# Plot the longwave water vapor feedback
qlw.mean(dim=&quot;time&quot;).plot(ax=ax,cmap=&quot;Reds&quot;, **plotargs)

# Add a title
ax.set_title(&quot;Time-averaged LW Water Vapor Feedback&quot;);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="vRoyT4e0FLhbRBKrTP349" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/radiative-feedback-cookbook/build/835c5e9bb6223bd7dc8f998529714790.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="ktFyJRskqA" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create the base map
fig, ax = base_map()

# Plot the longwave water vapor feedback 
(qlw.mean(dim=&quot;time&quot;)/Δts.mean(dim=&quot;time&quot;)).plot(ax=ax,cmap=&quot;Reds&quot;, **plotargs_2)
ax.coastlines()

# Add a title
ax.set_title(&quot;Time-averaged LW Water Vapor Feedback&quot;);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Jr5Q00hT4rohCfcaEH4yq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/radiative-feedback-cookbook/build/1971279117058e39a643ad753a2e091b.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="AU0lt3nZaU" class="relative group/block"><p>And now the shortwave...</p></div><div id="T3drg4Klsn" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create the base map
fig, ax = base_map()

# Plot the longwave water vapor feedback and add coastlines
qsw.mean(dim=&quot;time&quot;).plot(ax=ax,cmap=&quot;Reds&quot;, **plotargs)


# Add a title
ax.set_title(&quot;Time-averaged SW Water Vapor Feedback&quot;);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7xoYQVH9voCOU2p0xZH8s" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/radiative-feedback-cookbook/build/bc190dfeade6ce7b977ecee7d2cb2146.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="lI6OgGDSC2" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create the base map
fig, ax = base_map()

# Plot the longwave water vapor feedback and add coastlines
(qsw.mean(dim=&quot;time&quot;)/Δts.mean(dim=&quot;time&quot;)).plot(ax=ax,cmap=&quot;Reds&quot;, **plotargs_2)

# Add a title
ax.set_title(&quot;Time-averaged SW Water Vapor Feedback&quot;);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7zyhSLUM8aw27rQ-6X8yn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/radiative-feedback-cookbook/build/725135775721a81529c230b68266a5d9.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="ByCrgmHgCc" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Output the time-averaged global surface albedo feedback
output = (&quot;The global average longwave and shortwave water vapor feedbacks are&quot;+
          &quot; {lw:.2f} and {sw:.2f} W/m\u00b2/K, respectively.&quot;)
print(output.format(lw=float(ck.spat_avg((qlw.mean(dim=&quot;time&quot;)/Δts.mean(dim=&quot;time&quot;)
                                         ).expand_dims(&quot;time&quot;))),
                   sw=float(ck.spat_avg((qsw.mean(dim=&quot;time&quot;)/Δts.mean(dim=&quot;time&quot;)
                                        ).expand_dims(&quot;time&quot;)))))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9xm5ATluNFCzzxPzY2Ft2" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>The global average longwave and shortwave water vapor feedbacks are 1.59 and 0.19 W/m²/K, respectively.
</span></code></pre></div></div></div><div id="CM70KCpgKC" class="relative group/block"><h3 id="cloud-feedbacks" class="relative group"><span class="heading-text">Cloud feedbacks</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#cloud-feedbacks" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="lu2mZ0e72U" class="relative group/block"><h4 id="download-radiative-forcing" class="relative group"><span class="heading-text">Download radiative forcing</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#download-radiative-forcing" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="ybb6xXMWEM" class="relative group/block"><p>It’s time for cloud feedbacks. However, like anything to do with clouds, there are some complications. You ideally need the effective radiative forcing (ERF), which is a measure of radiative imbalance imposed by CO<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4511em;vertical-align:-0.15em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> in the absence of surface temperature change <cite class="" data-state="closed"><a href="https://doi.org/10.5194/acp-20-9591-2020" target="_blank" rel="noreferrer" class="hover-link">Smith et al., 2020</a></cite>. Thankfully, CESM2 radiative forcing for our scenarios is available on the Google cloud.</p></div><div id="EUrGaOVKKX" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Specify data location, open it
cat_url = &quot;https://storage.googleapis.com/cmip6/pangeo-cmip6.json&quot;
col = intake.open_esm_datastore(cat_url)

# # Create a catalog of matching simulations
cat = col.search(activity_id=&quot;RFMIP&quot;,source_id=&quot;CESM2&quot;,experiment_id=[&quot;piClim-4xCO2&quot;,
                                                                      &quot;piClim-control&quot;],
                variable_id=[&quot;rlut&quot;,&quot;rsut&quot;,&quot;rsdt&quot;])

# Convert to a dictionary of Xarray Datasets
ds_dict = cat.to_dataset_dict(zarr_kwargs={&#x27;consolidated&#x27;: True})

# Assign Datasets to variables
rf_ctrl = ds_dict[&quot;RFMIP.NCAR.CESM2.piClim-control.Amon.gn&quot;]
rf_pert = ds_dict[&quot;RFMIP.NCAR.CESM2.piClim-4xCO2.Amon.gn&quot;]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="kutYZpp0QqpiWFZtVRwju" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="mMIcA7xv2I" class="relative group/block"><div class="admonition alert alert-info"><p>Info</p>Your relevant information here!</div></div><div id="CRCR1zV8KJ" class="relative group/block"><p>Feel free to copy this around and edit or play around with yourself. Some other <code>admonitions</code> you can put in:</p></div><div id="jLRfgDbl8Z" class="relative group/block"><div class="admonition alert alert-success"><p>Success</p>We got this done after all!</div></div><div id="O7EHHqy8Ve" class="relative group/block"><div class="admonition alert alert-warning"><p>Warning</p>Be careful!</div></div><div id="ZHWGXcv2ZH" class="relative group/block"><div class="admonition alert alert-danger"><p>Danger</p>Scary stuff be here.</div></div><div id="lH1M6KiW0o" class="relative group/block"><p>We also suggest checking out Jupyter Book’s <a target="_blank" rel="noreferrer" href="https://jupyterbook.org/content/metadata.html#jupyter-cell-tags" class="">brief demonstration</a> on adding cell tags to your cells in Jupyter Notebook, Lab, or manually. Using these cell tags can allow you to <a target="_blank" rel="noreferrer" href="https://jupyterbook.org/interactive/hiding.html" class="">customize</a> how your code content is displayed and even <a target="_blank" rel="noreferrer" href="https://jupyterbook.org/content/execute.html#dealing-with-code-that-raises-errors" class="">demonstrate errors</a> without altogether crashing our loyal army of machines!</p></div><div id="kYRaxM7xKk" class="relative group/block"><hr class="py-2 my-5 translate-y-2"/></div><div></div><section id="references" class="article-grid subgrid-gap col-screen"><div><header class="text-lg font-semibold text-stone-900 dark:text-white group">References<a class="no-underline text-inherit hover:text-inherit ml-2 select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to References" aria-label="Link to References">¶</a></header></div><div class="pl-3 mb-8 text-xs text-stone-500 dark:text-stone-300"><ol><li class="break-words" id="cite-Janoski:2025a">Janoski, T. P., Mitevski, I., Kramer, R. J., Previdi, M., & Polvani, L. M. (2025). ClimKern v1.2: a new Python package and kernel repository for calculating radiative feedbacks. <i>Geoscientific Model Development</i>, <i>18</i>(10), 3065–3079. <a target="_blank" rel="noreferrer" href="https://doi.org/10.5194/gmd-18-3065-2025">10.5194/gmd-18-3065-2025</a></li><li class="break-words" id="cite-Smith_2020">Smith, C. J., Kramer, R. J., Myhre, G., Alterskjær, K., Collins, W., Sima, A., Boucher, O., Dufresne, J.-L., Nabat, P., Michou, M., Yukimoto, S., Cole, J., Paynter, D., Shiogama, H., O’Connor, F. M., Robertson, E., Wiltshire, A., Andrews, T., Hannay, C., … Forster, P. M. (2020). Effective radiative forcing and adjustments in CMIP6 models. <i>Atmospheric Chemistry and Physics</i>, <i>20</i>(16), 9591–9618. <a target="_blank" rel="noreferrer" href="https://doi.org/10.5194/acp-20-9591-2020">10.5194/acp-20-9591-2020</a></li></ol></div></section><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/radiative-feedback-cookbook/notebooks/foundations/manual-calc"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Foundations</div>Feedback analysis using radiative kernels</div></div></a></div></main></article><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/radiative-feedback-cookbook/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/radiative-feedback-cookbook/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/radiative-feedback-cookbook/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/radiative-feedback-cookbook/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/radiative-feedback-cookbook/build/_shared/chunk-JSE36H2O.js"/><link rel="modulepreload" href="/radiative-feedback-cookbook/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/radiative-feedback-cookbook/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/radiative-feedback-cookbook/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/radiative-feedback-cookbook/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/radiative-feedback-cookbook/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/radiative-feedback-cookbook/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/radiative-feedback-cookbook/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/radiative-feedback-cookbook/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/radiative-feedback-cookbook/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/radiative-feedback-cookbook/build/root-IB5726YR.js"/><link rel="modulepreload" href="/radiative-feedback-cookbook/build/_shared/chunk-NBON2RSI.js"/><link rel="modulepreload" href="/radiative-feedback-cookbook/build/routes/$-LXLHKVOR.js"/><script>window.__remixContext = {"url":"/notebooks/foundations/climkern-calc","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.0","options":{"favicon":"/radiative-feedback-cookbook/build/config-item-9b3afca6-ce30547837a5499f66fab26a4ed8d473.ico","logo":"/radiative-feedback-cookbook/build/pythia_logo-white-rt-39eeac595e9d350be72bf4671d97a787.svg","logo_dark":"/radiative-feedback-cookbook/build/config-item-84d6d338-d7bc03ca665c8748714f4efdbac698d9.svg","logo_url":"https://projectpythia.org","analytics_google":"G-T52X8HNYE8","folders":true},"parts":{},"nav":[{"title":"Home","url":"https://projectpythia.org"},{"title":"Foundations","url":"https://foundations.projectpythia.org"},{"title":"Cookbooks","url":"https://cookbooks.projectpythia.org/"},{"title":"Resources","url":"https://projectpythia.org/resource-gallery/"},{"title":"Community","url":"https://projectpythia.org/#join-us"}],"actions":[{"title":"Project Pythia","url":"https://projectpythia.org","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"bibliography":["/home/runner/work/radiative-feedback-cookbook/radiative-feedback-cookbook/bibliography.bib"],"title":"Radiative Feedback Cookbook","authors":[{"nameParsed":{"literal":"Project Pythia Community","given":"Project Pythia","family":"Community"},"name":"Project Pythia Community","url":"https://projectpythia.org/","id":"contributors-myst-generated-uid-0"}],"contributors":[{"id":"brian-rose","nameParsed":{"literal":"Brian E. J. Rose","given":"Brian E. J.","family":"Rose"},"name":"Brian E. J. Rose","orcid":"0000-0002-9961-3821","email":"brose@albany.edu","affiliations":["UAlbany"],"url":"https://brian-rose.github.io","github":"brian-rose","bluesky":"@brianejrose.bsky.social","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"},{"id":"clyne","nameParsed":{"literal":"John Clyne","given":"John","family":"Clyne"},"name":"John Clyne","orcid":"0000-0003-2788-9017","affiliations":["CISL"],"github":"clyne"},{"id":"jukent","nameParsed":{"literal":"Julia Kent","given":"Julia","family":"Kent"},"name":"Julia Kent","orcid":"0000-0002-5611-8986","affiliations":["CISL"],"github":"jukent"},{"id":"ktyle","nameParsed":{"literal":"Kevin Tyle","given":"Kevin","family":"Tyle"},"name":"Kevin Tyle","orcid":"0000-0001-5249-9665","affiliations":["UAlbany"],"github":"ktyle"},{"id":"andersy005","nameParsed":{"literal":"Anderson Banihirwe","given":"Anderson","family":"Banihirwe"},"name":"Anderson Banihirwe","orcid":"0000-0001-6583-571X","affiliations":["CarbonPlan"],"github":"andersy005"},{"id":"dcamron","nameParsed":{"literal":"Drew Camron","given":"Drew","family":"Camron"},"name":"Drew Camron","orcid":"0000-0001-7246-6502","affiliations":["Unidata"],"github":"dcamron"},{"id":"dopplershift","nameParsed":{"literal":"Ryan May","given":"Ryan","family":"May"},"name":"Ryan May","orcid":"0000-0003-2907-038X","affiliations":["Unidata"],"github":"dopplershift"},{"id":"mgrover1","nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","affiliations":["Argonne"],"github":"mgrover1"},{"id":"r-ford","nameParsed":{"literal":"Robert R. Ford","given":"Robert R.","family":"Ford"},"name":"Robert R. Ford","orcid":"0000-0001-5483-4965","affiliations":["UAlbany"],"github":"r-ford"},{"id":"kmpaul","nameParsed":{"literal":"Kevin Paul","given":"Kevin","family":"Paul"},"name":"Kevin Paul","orcid":"0000-0001-8155-8038","affiliations":["NVIDIA"],"github":"kmpaul"},{"id":"jnmorley","nameParsed":{"literal":"James Morley","given":"James","family":"Morley"},"name":"James Morley","orcid":"0009-0005-5193-7981","github":"jnmorley"},{"id":"erogluorhan","nameParsed":{"literal":"Orhan Eroglu","given":"Orhan","family":"Eroglu"},"name":"Orhan Eroglu","orcid":"0000-0003-3099-8775","affiliations":["CISL"],"github":"erogluorhan"},{"id":"lkailynncar","nameParsed":{"literal":"Lily Kailyn","given":"Lily","family":"Kailyn"},"name":"Lily Kailyn","orcid":"0009-0002-0125-5091","affiliations":["CISL"],"github":"lkailynncar"},{"id":"anissa111","nameParsed":{"literal":"Anissa Zacharias","given":"Anissa","family":"Zacharias"},"name":"Anissa Zacharias","orcid":"0000-0002-2666-8493","affiliations":["CISL"],"github":"anissa111"},{"id":"kafitzgerald","nameParsed":{"literal":"Katelyn FitzGerald","given":"Katelyn","family":"FitzGerald"},"name":"Katelyn FitzGerald","orcid":"0000-0003-4184-1917","affiliations":["CISL"],"github":"kafitzgerald"}],"github":"https://github.com/projectpythia/radiative-feedback-cookbook","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"copyright":"2024","references":{"foundations":{"url":"https://foundations.projectpythia.org"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://binder.projectpythia.org","provider":"github","repo":"projectpythia/radiative-feedback-cookbook","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"children":[{"file":"notebooks/foundations/energy-balance-model.ipynb"},{"file":"notebooks/foundations/manual-calc.ipynb"},{"file":"notebooks/foundations/climkern-calc.ipynb"}],"title":"Foundations"},{"children":[{"file":"references.md"}],"title":"Appendix"}],"thumbnail":"/radiative-feedback-cookbook/build/thumbnail-eac97f75cbeed83eb0ac174729026583.png","exports":[],"index":"index","pages":[{"level":1,"title":"Preamble"},{"slug":"notebooks.how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/radiative-feedback-cookbook/build/undefined","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Foundations"},{"slug":"notebooks.foundations.energy-balance-model","title":"Energy Balance Model and Feedbacks","description":"","date":"","thumbnail":"/radiative-feedback-cookbook/build/ProjectPythia_Logo_F-6ffb048ae19a63b323c6c8d8a8c9e365.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.foundations.manual-calc","title":"Feedback analysis using radiative kernels","description":"","date":"","thumbnail":"/radiative-feedback-cookbook/build/ProjectPythia_Logo_F-6ffb048ae19a63b323c6c8d8a8c9e365.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.foundations.climkern-calc","title":"Feedbacks with ClimKern","description":"","date":"","thumbnail":"/radiative-feedback-cookbook/build/ClimKern-logo-a20c73e644259e4ef5ac632daf3ae05d.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Appendix"}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/radiative-feedback-cookbook"},"routes/$":{"config":{"version":2,"myst":"1.6.0","options":{"favicon":"/radiative-feedback-cookbook/build/config-item-9b3afca6-ce30547837a5499f66fab26a4ed8d473.ico","logo":"/radiative-feedback-cookbook/build/pythia_logo-white-rt-39eeac595e9d350be72bf4671d97a787.svg","logo_dark":"/radiative-feedback-cookbook/build/config-item-84d6d338-d7bc03ca665c8748714f4efdbac698d9.svg","logo_url":"https://projectpythia.org","analytics_google":"G-T52X8HNYE8","folders":true},"parts":{},"nav":[{"title":"Home","url":"https://projectpythia.org"},{"title":"Foundations","url":"https://foundations.projectpythia.org"},{"title":"Cookbooks","url":"https://cookbooks.projectpythia.org/"},{"title":"Resources","url":"https://projectpythia.org/resource-gallery/"},{"title":"Community","url":"https://projectpythia.org/#join-us"}],"actions":[{"title":"Project Pythia","url":"https://projectpythia.org","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"bibliography":["/home/runner/work/radiative-feedback-cookbook/radiative-feedback-cookbook/bibliography.bib"],"title":"Radiative Feedback Cookbook","authors":[{"nameParsed":{"literal":"Project Pythia Community","given":"Project Pythia","family":"Community"},"name":"Project Pythia Community","url":"https://projectpythia.org/","id":"contributors-myst-generated-uid-0"}],"contributors":[{"id":"brian-rose","nameParsed":{"literal":"Brian E. J. Rose","given":"Brian E. J.","family":"Rose"},"name":"Brian E. J. Rose","orcid":"0000-0002-9961-3821","email":"brose@albany.edu","affiliations":["UAlbany"],"url":"https://brian-rose.github.io","github":"brian-rose","bluesky":"@brianejrose.bsky.social","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"},{"id":"clyne","nameParsed":{"literal":"John Clyne","given":"John","family":"Clyne"},"name":"John Clyne","orcid":"0000-0003-2788-9017","affiliations":["CISL"],"github":"clyne"},{"id":"jukent","nameParsed":{"literal":"Julia Kent","given":"Julia","family":"Kent"},"name":"Julia Kent","orcid":"0000-0002-5611-8986","affiliations":["CISL"],"github":"jukent"},{"id":"ktyle","nameParsed":{"literal":"Kevin Tyle","given":"Kevin","family":"Tyle"},"name":"Kevin Tyle","orcid":"0000-0001-5249-9665","affiliations":["UAlbany"],"github":"ktyle"},{"id":"andersy005","nameParsed":{"literal":"Anderson Banihirwe","given":"Anderson","family":"Banihirwe"},"name":"Anderson Banihirwe","orcid":"0000-0001-6583-571X","affiliations":["CarbonPlan"],"github":"andersy005"},{"id":"dcamron","nameParsed":{"literal":"Drew Camron","given":"Drew","family":"Camron"},"name":"Drew Camron","orcid":"0000-0001-7246-6502","affiliations":["Unidata"],"github":"dcamron"},{"id":"dopplershift","nameParsed":{"literal":"Ryan May","given":"Ryan","family":"May"},"name":"Ryan May","orcid":"0000-0003-2907-038X","affiliations":["Unidata"],"github":"dopplershift"},{"id":"mgrover1","nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","affiliations":["Argonne"],"github":"mgrover1"},{"id":"r-ford","nameParsed":{"literal":"Robert R. Ford","given":"Robert R.","family":"Ford"},"name":"Robert R. Ford","orcid":"0000-0001-5483-4965","affiliations":["UAlbany"],"github":"r-ford"},{"id":"kmpaul","nameParsed":{"literal":"Kevin Paul","given":"Kevin","family":"Paul"},"name":"Kevin Paul","orcid":"0000-0001-8155-8038","affiliations":["NVIDIA"],"github":"kmpaul"},{"id":"jnmorley","nameParsed":{"literal":"James Morley","given":"James","family":"Morley"},"name":"James Morley","orcid":"0009-0005-5193-7981","github":"jnmorley"},{"id":"erogluorhan","nameParsed":{"literal":"Orhan Eroglu","given":"Orhan","family":"Eroglu"},"name":"Orhan Eroglu","orcid":"0000-0003-3099-8775","affiliations":["CISL"],"github":"erogluorhan"},{"id":"lkailynncar","nameParsed":{"literal":"Lily Kailyn","given":"Lily","family":"Kailyn"},"name":"Lily Kailyn","orcid":"0009-0002-0125-5091","affiliations":["CISL"],"github":"lkailynncar"},{"id":"anissa111","nameParsed":{"literal":"Anissa Zacharias","given":"Anissa","family":"Zacharias"},"name":"Anissa Zacharias","orcid":"0000-0002-2666-8493","affiliations":["CISL"],"github":"anissa111"},{"id":"kafitzgerald","nameParsed":{"literal":"Katelyn FitzGerald","given":"Katelyn","family":"FitzGerald"},"name":"Katelyn FitzGerald","orcid":"0000-0003-4184-1917","affiliations":["CISL"],"github":"kafitzgerald"}],"github":"https://github.com/projectpythia/radiative-feedback-cookbook","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"copyright":"2024","references":{"foundations":{"url":"https://foundations.projectpythia.org"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://binder.projectpythia.org","provider":"github","repo":"projectpythia/radiative-feedback-cookbook","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"children":[{"file":"notebooks/foundations/energy-balance-model.ipynb"},{"file":"notebooks/foundations/manual-calc.ipynb"},{"file":"notebooks/foundations/climkern-calc.ipynb"}],"title":"Foundations"},{"children":[{"file":"references.md"}],"title":"Appendix"}],"thumbnail":"/radiative-feedback-cookbook/build/thumbnail-eac97f75cbeed83eb0ac174729026583.png","exports":[],"index":"index","pages":[{"level":1,"title":"Preamble"},{"slug":"notebooks.how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/radiative-feedback-cookbook/build/undefined","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Foundations"},{"slug":"notebooks.foundations.energy-balance-model","title":"Energy Balance Model and Feedbacks","description":"","date":"","thumbnail":"/radiative-feedback-cookbook/build/ProjectPythia_Logo_F-6ffb048ae19a63b323c6c8d8a8c9e365.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.foundations.manual-calc","title":"Feedback analysis using radiative kernels","description":"","date":"","thumbnail":"/radiative-feedback-cookbook/build/ProjectPythia_Logo_F-6ffb048ae19a63b323c6c8d8a8c9e365.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.foundations.climkern-calc","title":"Feedbacks with ClimKern","description":"","date":"","thumbnail":"/radiative-feedback-cookbook/build/ClimKern-logo-a20c73e644259e4ef5ac632daf3ae05d.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Appendix"}]}]},"page":{"version":2,"kind":"Notebook","sha256":"319fd64e34cebbf34d29782d365a1725f26a71581e237c5a54868baa173e53d9","slug":"notebooks.foundations.climkern-calc","location":"/notebooks/foundations/climkern-calc.ipynb","dependencies":[],"frontmatter":{"title":"Feedbacks with ClimKern","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Project Pythia Community","given":"Project Pythia","family":"Community"},"name":"Project Pythia Community","url":"https://projectpythia.org/","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/radiative-feedback-cookbook","copyright":"2024","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/radiative-feedback-cookbook/blob/main/notebooks/foundations/climkern-calc.ipynb","thumbnail":"/radiative-feedback-cookbook/build/ClimKern-logo-a20c73e644259e4ef5ac632daf3ae05d.png","exports":[{"format":"ipynb","filename":"climkern-calc.ipynb","url":"/radiative-feedback-cookbook/build/climkern-calc-86508277883c5c40cf4a23a32ce6f559.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/radiative-feedback-cookbook/build/ClimKern-logo-a20c73e644259e4ef5ac632daf3ae05d.png","alt":"ClimKern Python Package Logo","width":"250px","align":"center","key":"ZHtsL4XnbO","urlSource":"../images/logos/ClimKern-logo.png"}],"key":"DrckscKi1k"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a3e4rD8xox"}],"key":"oQDL8tV8cj"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AFaOppwYVC"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"OVVPbOA4m4"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"While it is good to know how to manually calculate radiative feedbacks, it is also time-consuming to constantly recreate the code. Here, we will use a Python package called ClimKern ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wuS19I30zi"},{"type":"citeGroup","kind":"parenthetical","children":[{"type":"cite","kind":"parenthetical","label":"Janoski:2025a","identifier":"janoski:2025a","children":[{"type":"text","value":"Janoski ","key":"nohLWlj4v9"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"tjSILHTVOv"}],"key":"FXeNLF6aX8"},{"type":"text","value":", 2025","key":"GmpoVoRuvI"}],"enumerator":"1","key":"HB2ZQICgDu"}],"key":"bD0fSvrQYA"},{"type":"text","value":" that offers functions to calculate radiative feedbacks from climate model or reanalysis output. The advantages of using ClimKern go beyond making it simpler—it standardizes the methods and assumptions that go into these sometimes complicated calculations. We will use CMIP6 output in this notebook. You will learn how to:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jjkU1hS39s"}],"key":"hUjQBdHhLZ"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Download CMIP6 data from Pangeo’s space on Google Cloud.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Yqsqyz1q1U"}],"key":"ufNqQh2NTC"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Obtain a radiative kernel from the ClimKern repository.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"WXkgQxB5og"}],"key":"y14lGbkh1z"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Calculate the surface albedo, temperature, and water vapor feedbacks.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xvsFNoHsMj"}],"key":"Sxb2bzOqcS"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Compute the cloud feedbacks using the two main methods: residual and adjustment.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"rO0xvmUzMk"}],"key":"yh6oTsZ7ox"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Quantify stratospheric feedbacks.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Y5ZQB1SL4h"}],"key":"bUocgnHVtW"}],"key":"R2fDd7y9fX"}],"key":"G1tdLJvxxw"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jGlQyqnvc5"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"NzThhtMBh8"},{"type":"table","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FW7Bzg5COe"}],"key":"dankT9HDaF"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MTeQCcqAgU"}],"key":"Vx5hii4wdh"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"s2wxmYvOAQ"}],"key":"Oc13L1b5lZ"}],"key":"PtuYwqtXkB"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/xarray/xarray-intro","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Intro to Xarray","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"T75vW8Debw"}],"urlSource":"https://foundations.projectpythia.org/core/xarray/xarray-intro","key":"YZy5T8MFwB"}],"key":"GjvuzLNqQB"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QEvuX1JV24"}],"key":"b4u9LgGOEQ"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[],"key":"woVzPb357Y"}],"key":"uLJtSk4rN7"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/cartopy/cartopy","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Intro to Cartopy","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"F5AMEGDgGD"}],"urlSource":"https://foundations.projectpythia.org/core/cartopy/cartopy","key":"Li9ClqYXRy"}],"key":"twsxwvwYwk"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"kAZNV5ghzC"}],"key":"DRhNtQXWsh"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[],"key":"OHgyma25eU"}],"key":"QTbJj1spOi"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/matplotlib/matplotlib-basics","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Intro to Matplotlib","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"lTC1jS0cX9"}],"urlSource":"https://foundations.projectpythia.org/core/matplotlib/matplotlib-basics","key":"HuDvgUyPb7"}],"key":"F1NN93Xnlk"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ggooZSt2Uc"}],"key":"q29E4QO3k5"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[],"key":"NFPBAKGrjl"}],"key":"wsXaaso3uv"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"link","url":"https://projectpythia.org/cmip6-cookbook/notebooks/foundations/intake-esm","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Loading CMIP6 Data with Intake-ESM","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"OdVjx6OsuD"}],"urlSource":"https://projectpythia.org/cmip6-cookbook/notebooks/foundations/intake-esm","key":"WcxUJQgpat"}],"key":"u7CQID1Isu"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"h0S5LaixMP"}],"key":"B7lDlKe1m1"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[],"key":"uVETcIcU1A"}],"key":"IUcxogHbSD"}],"key":"w0X9f5pmtp"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Time to learn","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"qYWCqZ6TsF"}],"key":"aOsc0Ri3y0"},{"type":"text","value":": 20 minutes","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"iUVJrqPcfW"}],"key":"zR1wrR1n5X"}],"key":"sMnxEpSbOe"}],"key":"AfKFpOaAhF"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IjHP6RLjos"}],"key":"wZKeOrmjj6"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"as0HMCKeZ6"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"Sktn2IQxjd"}],"key":"wck7bbQTDO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import climkern as ck\nimport intake\nimport matplotlib.pyplot as plt\nimport s3fs\nimport fsspec\nimport xarray as xr\nimport glob\nimport importlib.util\nimport os\nimport cartopy.crs as ccrs\n\n%matplotlib inline\nplt.rcParams[\"figure.dpi\"] = 100","key":"xKixSTmtaS"},{"type":"output","id":"XpvczVE6dFBtzrfrAQ8sn","data":[],"key":"SPIMokeTYb"}],"key":"gLxCUbDK64"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Download the kernel","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qqUnpRe0v3"}],"identifier":"download-the-kernel","label":"Download the kernel","html_id":"download-the-kernel","implicit":true,"key":"PUwtOPTa1Q"}],"key":"c4RkNfx3tI"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Normally, when ClimKern is installed, the user needs to download data on the command\nline from the Zenodo repository. However, we now have the data on Jetstream2, so\nwe can download it from there and save it in our package repository.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c7Dd5nITeF"}],"key":"pNzhevpfM5"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"U2Kb36Xpf2"}],"key":"VulZln1DUt"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Future versions of ClimKern will be able to pull the kernel from Jetstream2 without storing locally.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"UZ5F9V850o"}],"key":"AEchBOyvQR"}],"key":"ULI57JxxKv"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"First, set the URL and path to point to ClimKern. Also, specify which kernel you want.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"p2zuhYZGSt"}],"key":"jWe61ARgYf"}],"key":"NgE9xpxMdM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"URL = \"https://js2.jetstream-cloud.org:8001/\" # URL for jetstream access\npath = f\"pythia/ClimKern\" # Location of ClimKern\nkernel = \"ERA5\"","key":"wJcftxsLRM"},{"type":"output","id":"3WsPHaridxZS2740ejM53","data":[],"key":"v2GKKS5EX4"}],"key":"duoDsIxOvG"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next, read in the data from Jetstream2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u96LU8J1wJ"}],"key":"rCbZLeCcar"}],"key":"LJ8HT3CZcD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Read in data\n# Set up access to jetstream2\nfs = fsspec.filesystem(\"s3\", anon=True, client_kwargs=dict(endpoint_url=URL))\npattern = f\"s3://{path}/kernels/\"+kernel+f\"/TOA*.nc\"\n\n# Grab the data\nfiles = sorted(fs.glob(pattern))\nfs.invalidate_cache() # This is necessary to deal with peculiarities of objects served from jetstream2\n\n# Open file and make it Xarray Dataset\nkern = xr.open_dataset(fs.open(files[0]))\n\n# Save path for later\npath_out = files[0].split(kernel+\"/\",1)[1]","key":"CXy9DcZ6Tv"},{"type":"output","id":"QdtJ8yEjqlE_NPU_Rj4NW","data":[],"key":"k9BeGlT9qM"}],"key":"HGbnaVXVZI"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To save this data in ClimKern’s directory, we have to figure out where it is on the\nmachine. After that, we will go ahead and save out the kernel as a netCDF in\nClimKern’s local data directory.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"e2jDe0TIsF"}],"key":"aFiT9pMKLY"}],"key":"tRCfdqIarF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Get the package location\nspec = importlib.util.find_spec(\"climkern\")\npackage_dir = os.path.dirname(spec.origin)\n\n# print(f\"The package directory is: {package_dir}\")\n\n# Define the path where you want to save the netCDF file within the package directory\nnetcdf_path = os.path.join(package_dir,\"data/kernels\",kernel,path_out)\n\n# Ensure the directory exists\nos.makedirs(os.path.dirname(netcdf_path), exist_ok=True)\n\n# Save the dataset as a netCDF file\nkern.to_netcdf(netcdf_path)","key":"IMVHApmubG"},{"type":"output","id":"IHIeXHn3ShyLbgXhpebxE","data":[],"key":"QqCWiTLyNd"}],"key":"tYlamczhmx"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, let’s just make sure we can retrieve the kernel.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eAduQSJ1J2"}],"key":"cOHjIhSSyt"}],"key":"ktC6d9wi7I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ck.util.get_kern(kernel)","key":"Cpxle8vFQq"},{"type":"output","id":"qzn5xovWU9mAqI-wBJg3C","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"\u003cxarray.Dataset\u003e Size: 228MB\nDimensions:   (time: 12, plev: 37, lat: 73, lon: 144)\nCoordinates:\n  * plev      (plev) float32 148B 1e+03 975.0 950.0 925.0 ... 5.0 3.0 2.0 1.0\n  * lat       (lat) float32 292B 90.0 87.5 85.0 82.5 ... -82.5 -85.0 -87.5 -90.0\n  * lon       (lon) float32 576B 0.0 2.5 5.0 7.5 ... 350.0 352.5 355.0 357.5\n  * time      (time) int64 96B 0 1 2 3 4 5 6 7 8 9 10 11\nData variables:\n    lwclr_t   (time, plev, lat, lon) float64 37MB ...\n    lw_t      (time, plev, lat, lon) float64 37MB ...\n    lwclr_q   (time, plev, lat, lon) float64 37MB ...\n    lw_q      (time, plev, lat, lon) float64 37MB ...\n    swclr_q   (time, plev, lat, lon) float64 37MB ...\n    sw_q      (time, plev, lat, lon) float64 37MB ...\n    swclr_a   (time, lat, lon) float64 1MB ...\n    sw_a      (time, lat, lon) float64 1MB ...\n    lwclr_ts  (time, lat, lon) float64 1MB ...\n    lw_ts     (time, lat, lon) float64 1MB ...","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"d8b698ba96830eb07ac86fd2a2ade879","path":"/radiative-feedback-cookbook/build/d8b698ba96830eb07ac86fd2a2ade879.html"}}}],"key":"u6Jf5k1QzR"}],"key":"svU6YzIkUy"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prepare the CMIP6 Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SoOfFQakl7"}],"identifier":"prepare-the-cmip6-data","label":"Prepare the CMIP6 Data","html_id":"prepare-the-cmip6-data","implicit":true,"key":"oLw8jnDrDt"}],"key":"ji8L55Y37t"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"To start, we will need some CMIP6 data to calculate feedbacks. We will use the\npreindustrial control and 4×CO","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fO7trIIcPY"},{"type":"inlineMath","value":"_2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmrow\u003e\u003c/mrow\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e_2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4511em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"XohCWg2NI3"},{"type":"text","value":" experiments from just one model (CESM2).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K7QAUYYoaI"}],"key":"KzGSZPW3j8"}],"key":"QTawOwAuv6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Make a list of variables and experiments we need\nvar_list = [\"rsds\",\"rsus\",\"ta\",\"ts\",\"ps\",\"hus\"]\nexp_list = [\"piControl\",\"abrupt-4xCO2\"]\n\n# Specify data location, open it\ncat_url = \"https://storage.googleapis.com/cmip6/pangeo-cmip6.json\"\ncol = intake.open_esm_datastore(cat_url)\n\n# Create a catalog of matching simulations\ncat = col.search(experiment_id=exp_list,source_id=\"CESM2\",variable_id=var_list,\n                table_id=\"Amon\")\n\n# Convert to a dictionary of Xarray Datasets\nds_dict = cat.to_dataset_dict(zarr_kwargs={'consolidated': True})","key":"ipJvhaK4sU"},{"type":"output","id":"Mk9U8fL-JqhYg3sSrVKvw","data":[{"output_type":"stream","name":"stdout","text":"\n--\u003e The keys in the returned dictionary of datasets are constructed as follows:\n\t'activity_id.institution_id.source_id.experiment_id.table_id.grid_label'\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cIPython.core.display.HTML object\u003e","content_type":"text/plain"},"text/html":{"content":"\n\u003cstyle\u003e\n    /* Turns off some styling */\n    progress {\n        /* gets rid of default border in Firefox and Opera. */\n        border: none;\n        /* Needs to be in here for Safari polyfill so background images work as expected. */\n        background-size: auto;\n    }\n    progress:not([value]), progress:not([value])::-webkit-progress-bar {\n        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);\n    }\n    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {\n        background: #F44336;\n    }\n\u003c/style\u003e\n","content_type":"text/html"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cIPython.core.display.HTML object\u003e","content_type":"text/plain"},"text/html":{"content":"\n    \u003cdiv\u003e\n      \u003cprogress value='0' class='' max='2' style='width:300px; height:20px; vertical-align: middle;'\u003e\u003c/progress\u003e\n      \n    \u003c/div\u003e\n    ","content_type":"text/html"}}}],"key":"MzFmqhDH1z"}],"key":"Q6TeHQFa0b"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The data, especially the preindustrial control simulation that will serve as our\ncontrol climate, is huge. We are going to only use the last 50 years of the control\nand last 30 years of the abrupt 4×CO","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pBLQU3tzeG"},{"type":"inlineMath","value":"_2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmrow\u003e\u003c/mrow\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e_2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4511em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"h4hDQlSB1Z"},{"type":"text","value":" simulation. There are a few extra coordinates\nand/or dimensions we don’t need, hence the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NsFfOlrKLQ"},{"type":"inlineCode","value":"squeeze()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HIJfhF5zLz"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hCDTlIgTBT"}],"key":"OhK1Zgk8uk"}],"key":"jZcZxZaNo7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Our control simulation\nctrl = ds_dict[\"CMIP.NCAR.CESM2.piControl.Amon.gn\"].isel(\n    time=slice(-600,None)).squeeze().compute()\n\n# The increase CO2 aka \"perturbed\" simulation\npert = ds_dict[\"CMIP.NCAR.CESM2.abrupt-4xCO2.Amon.gn\"].isel(\n    time=slice(-360,None)).squeeze().compute()","key":"fH6l7RD9Ut"},{"type":"output","id":"cs6MtzltE3wKjkGEBRc7v","data":[],"key":"CI6tqbzotQ"}],"key":"Q8n7lzgrDz"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"To save a little diskspace because ClimKern still isn’t dask compatible yet,\nlet’s make our control climatology ahead of time.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TWYumqWenq"}],"key":"E4TWZdL4Gi"}],"key":"soB1ALBcE7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ctrl = ctrl.groupby(ctrl.time.dt.month).mean(dim=\"time\").rename({\"month\":\"time\"})\npert = pert.groupby(pert.time.dt.month).mean(dim=\"time\").rename({\"month\":\"time\"})","key":"PqhxgwAuZP"},{"type":"output","id":"pNv1F8Id7bLZk7wszUb4S","data":[],"key":"NbRt4yCufj"}],"key":"PO5NrZYOLq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Feedback calculations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BCSa5uGZnD"}],"identifier":"feedback-calculations","label":"Feedback calculations","html_id":"feedback-calculations","implicit":true,"key":"Hgu2bGbR5U"}],"key":"HZ7KPhEmT2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Calculate surface temperature change","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J6JZPnsiEK"}],"identifier":"calculate-surface-temperature-change","label":"Calculate surface temperature change","html_id":"calculate-surface-temperature-change","implicit":true,"key":"J7ic00ypNx"}],"key":"T0x8qnWCib"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"ClimKern outputs feedbacks as radiative perturbations at the TOA (because there are multiple ways to quantify feedbacks). One of the most common ways is to normalize by the change in the surface temperature, which puts values in “true” feedback units of W/m","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j7OjYgbN8j"},{"type":"inlineMath","value":"^2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmrow\u003e\u003c/mrow\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e^2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8141em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"iNWeOh6DnU"},{"type":"text","value":"/K. For that, we start by calculating the change in the surface temperature in our CESM2 experiment.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pO5vwmxuf1"}],"key":"dB3iPooX0y"}],"key":"HBEJpkElMf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Take difference between pert and ctrl ts fields\nΔts = pert.ts - ctrl.ts","key":"dPopDtrr9N"},{"type":"output","id":"7HCFIfdBvKJ3u3bu2a1Aw","data":[],"key":"hAMuT19FtG"}],"key":"gLgRtSHpZZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Surface albedo feedback","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nx93yhBhwU"}],"identifier":"surface-albedo-feedback","label":"Surface albedo feedback","html_id":"surface-albedo-feedback","implicit":true,"key":"a7NLzDMb4L"}],"key":"Qu009LLRZB"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Perhaps the simplest of the radiative feedbacks to calculate is the surface albedo\nfeedback because it requires only two variables and is a 3-dimensional field (no height\ncoordinate). The variables we will use are as follows:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vzlfVlczbP"}],"key":"h9BYp0eByD"},{"type":"table","position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Variable name","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BlI3AQ5KST"}],"key":"McqerVyfiJ"},{"type":"tableCell","header":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Description","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jllI8UdCyx"}],"key":"s9Db7JCrvC"},{"type":"tableCell","header":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Units","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fK12FcoJCK"}],"key":"Y2T7IUvaHj"}],"key":"sZZBvOHWEC"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"emphasis","children":[{"type":"text","value":"rsus","key":"tubsw3hHMR"}],"key":"G8nRMjFfqc"}],"key":"u0HqkH1mSF"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The upwelling shortwave radiation at the surface","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hXuyLjN8dm"}],"key":"gPjXczWi4d"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"W/m","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vbS66EkAxV"},{"type":"inlineMath","value":"^2","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmrow\u003e\u003c/mrow\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e^2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8141em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"KP3l54FaBB"}],"key":"UVUFae7IVO"}],"key":"KOOOHcqqsE"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"emphasis","children":[{"type":"text","value":"rsds","key":"GsKuRV1uKV"}],"key":"BuEi9Izayx"}],"key":"z98OAm6y2v"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"The downwelling shortwave radiation at the surface","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"wL8LmmHU4t"}],"key":"gFP3JQCNie"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"W/m","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"w3PN3MOJtz"},{"type":"inlineMath","value":"^2","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmrow\u003e\u003c/mrow\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e^2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8141em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"T2eg4oZ0rd"}],"key":"vZd5Nl75wb"}],"key":"P4Anfskxbf"}],"key":"bB0toPRDdt"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"kGYbQey4Tl"},{"type":"link","url":"https://tyfolino.github.io/climkern/climkern.html#climkern.calc_alb_feedback","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"inlineCode","value":"calc_alb_feedback()","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"jdpJMlMsc9"}],"urlSource":"https://tyfolino.github.io/climkern/climkern.html#climkern.calc_alb_feedback","key":"tvtZdrxyJZ"},{"type":"text","value":" function is straightforward. Be sure to include our kernel name\nin the arguments.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ZNgQ5cpTjJ"}],"key":"NLiEPZYYiq"}],"key":"MpeY78exvZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"alb = ck.calc_alb_feedback(\n    ctrl.rsus,ctrl.rsds,pert.rsus,pert.rsds,kern=\"ERA5\"\n)","key":"MD4sm7GI2D"},{"type":"output","id":"gfpaa2SDYosyfX40dpuLa","data":[],"key":"jUrxma6pmC"}],"key":"UFpcCD1Eop"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s see what the resulting Dataarray looks like.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uLj4NLVqiI"}],"key":"tBVwwubxR5"}],"key":"K8IOghqMIM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"alb","key":"FdxEIVaao8"},{"type":"output","id":"yQEktPYu23fTCaH0CciRm","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"\u003cxarray.DataArray (time: 12, lat: 192, lon: 288)\u003e Size: 5MB\narray([[[ 6.37567007,  6.37587678,  6.37571601, ...,  6.37583085,\n          6.37569304,  6.37567007],\n        [ 7.78089115,  7.74121131,  7.52827039, ...,  7.77247909,\n          7.78054506,  7.77778311],\n        [ 8.35004918,  8.26608999,  8.37383311, ...,  8.69215225,\n          8.72858185,  8.55825566],\n        ...,\n        [ 0.        ,  0.        ,  0.        , ...,  0.        ,\n          0.        ,  0.        ],\n        [ 0.        ,  0.        ,  0.        , ...,  0.        ,\n          0.        ,  0.        ],\n        [ 0.        ,  0.        ,  0.        , ...,  0.        ,\n          0.        ,  0.        ]],\n\n       [[ 2.8560899 ,  2.85585563,  2.85571247, ...,  2.85606387,\n          2.85580357,  2.85632417],\n        [ 3.39416073,  3.37326345,  3.28367702, ...,  3.4213705 ,\n          3.41856981,  3.40365677],\n        [ 3.86176106,  3.85026465,  3.87090275, ...,  3.92779249,\n          3.94960979,  3.91906328],\n...\n        [ 0.        ,  0.        ,  0.        , ...,  0.        ,\n          0.        ,  0.        ],\n        [ 0.        ,  0.        ,  0.        , ...,  0.        ,\n          0.        ,  0.        ],\n        [ 0.        ,  0.        ,  0.        , ...,  0.        ,\n          0.        ,  0.        ]],\n\n       [[ 4.25252144,  4.2533313 ,  4.25267329, ...,  4.25254675,\n          4.25295168,  4.25188874],\n        [ 5.62174816,  5.61441477,  5.5889846 , ...,  5.61069693,\n          5.60979497,  5.61671867],\n        [ 5.40845919,  5.34866197,  5.31832507, ...,  5.57945217,\n          5.53985686,  5.49172675],\n        ...,\n        [ 0.        ,  0.        ,  0.        , ...,  0.        ,\n          0.        ,  0.        ],\n        [ 0.        ,  0.        ,  0.        , ...,  0.        ,\n          0.        ,  0.        ],\n        [ 0.        ,  0.        ,  0.        , ...,  0.        ,\n          0.        ,  0.        ]]], shape=(12, 192, 288))\nCoordinates:\n  * lat             (lat) float64 2kB -90.0 -89.06 -88.12 ... 88.12 89.06 90.0\n  * lon             (lon) float64 2kB 0.0 1.25 2.5 3.75 ... 356.2 357.5 358.8\n    member_id       \u003cU8 32B 'r1i1p1f1'\n    dcpp_init_year  object 8B None\n  * time            (time) int64 96B 1 2 3 4 5 6 7 8 9 10 11 12","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"620d6ec7b5ed1159358f79bf918c385c","path":"/radiative-feedback-cookbook/build/620d6ec7b5ed1159358f79bf918c385c.html"}}}],"key":"SP29QRSsa8"}],"key":"nsqYdxCCta"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This function allows for the quick creation of a pre-configured map, eliminating the need to repeat setup code by setting up the figure, axes, and Cartopy Robinson projection.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"olSKg6uRV4"}],"key":"tVIHaN78j1"}],"key":"W6T2yiK02O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def base_map():\n    proj= ccrs.Robinson()  #select Robinson projection\n\n    fig, ax = plt.subplots(subplot_kw=dict(projection=proj)) #Create the figure and axis \n \n    ax.coastlines() # Add coastlines\n\n    return fig, ax\n\n","key":"F4vdkNxjCR"},{"type":"output","id":"8I4kiiI1wYAuyH9iU0ZgI","data":[],"key":"B3WXuANMIe"}],"key":"FJ6E6CulP5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Similar to the function above, these dictionaries encapsulate the repetitive code setup and provide a set of reusable arguments to simplify the plotting of data onto this map.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vsv1iMB73t"}],"key":"gpP7Km4AeX"}],"key":"D815ZBASkn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plotargs = {'transform': ccrs.PlateCarree(),\n            'cbar_kwargs': {\"orientation\": \"horizontal\", \"shrink\": 0.7, \n                            \"label\":\"W/m$^2$\"}\n            }","key":"ZtFeBlpyej"},{"type":"output","id":"tw2P0GVA-EAjlymdOgI8g","data":[],"key":"BuP4P51dP7"}],"key":"k47q9hy4Iy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plotargs_2 = {'transform': ccrs.PlateCarree(),\n            'cbar_kwargs': {\"orientation\": \"horizontal\", \"shrink\": 0.7,\n                           \"label\":\"W/m$^2$/K\"}\n            }","key":"qHukVCOzOl"},{"type":"output","id":"73IiA40ScNdIaD9jb_I9x","data":[],"key":"Dh65hX9J1S"}],"key":"vo8Yjbl9m1"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Finally, let’s plot the time average surface albedo feedback on a map, first as just the perturbation.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rmk4260tcF"}],"key":"O4pdIlgHFe"}],"key":"lNUVBJbTAz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create the base map\nfig, ax = base_map()\n\n# Plot the surface albedo feedback \nalb.mean(dim=\"time\").plot(ax=ax, **plotargs)\n\n# Add a title\nax.set_title(\"Time-averaged Surface Albedo Feedback\");","key":"R0ftdIn36A"},{"type":"output","id":"Dj6SnICPwaVwHqCa_H4JB","data":[{"output_type":"stream","name":"stderr","text":"DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/110m_physical/ne_110m_coastline.zip\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"d49c5a85865467e6a8d176e03d6c531b","path":"/radiative-feedback-cookbook/build/d49c5a85865467e6a8d176e03d6c531b.png"}}}],"key":"IB4EXU7Lyk"}],"key":"dApwK79mKg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now normalized by the surface temperature change...","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rf4eJvPjGL"}],"key":"xo83x0ixZC"}],"key":"Vv547DoZqs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create the base map\nfig, ax = base_map()\n\n# Plot surface albedo feedback \u0026 add coastlines\n(alb.mean(dim=\"time\")/Δts.mean(dim=\"time\")).plot(ax=ax, **plotargs_2)\n\n# Add a title\nax.set_title(\"Time-averaged Surface Albedo Feedback\");","key":"niedLk0AAp"},{"type":"output","id":"Mrf9_PMWLp0mQBTIkMccm","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"7b8c2f61d3281cbd310da6a5c49c6e43","path":"/radiative-feedback-cookbook/build/7b8c2f61d3281cbd310da6a5c49c6e43.png"}}}],"key":"Afw152zy8l"}],"key":"hk04Z8iTVz"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As one might expect, the greatest radiative change at the TOA from the surface albedo feedback is near the poles where there is melting sea ice and snow.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DPU9K9sRXf"}],"key":"Kzr7aVzsFO"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s end by calculating the global average. ClimKern comes with a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oZnmAz7E6M"},{"type":"link","url":"https://tyfolino.github.io/climkern/climkern.html#climkern.spat_avg","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"spat_avg()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LTjeyhxVfE"}],"urlSource":"https://tyfolino.github.io/climkern/climkern.html#climkern.spat_avg","key":"V3zhP4iW0z"},{"type":"text","value":" function.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HbrKIWrUlG"}],"key":"mCJkxEelk8"}],"key":"ZMvBLVumW8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Output the time-averaged global surface albedo feedback\noutput = \"The global average surface albedo feedback is {value:.2f} W/m\\u00b2/K.\"\nprint(output.format(value=float(ck.spat_avg((alb.mean(dim=\"time\")/Δts.mean(dim=\"time\")\n                                         ).expand_dims(\"time\")))))","key":"OC3KkT0w1y"},{"type":"output","id":"un7dBQgFzzMzRnMTiJwKS","data":[{"output_type":"stream","name":"stdout","text":"The global average surface albedo feedback is 0.23 W/m²/K.\n"}],"key":"dAyHMkaZuf"}],"key":"kIlUUNfkVE"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Planck and lapse rate feedbacks","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LRghFHVT0m"}],"identifier":"planck-and-lapse-rate-feedbacks","label":"Planck and lapse rate feedbacks","html_id":"planck-and-lapse-rate-feedbacks","implicit":true,"key":"jBb8TyBzWi"}],"key":"MVwwbrNzL0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As a reminder, the total tropospheric temperature feedback is often decomposed into a distict Planck and lapse rate feedback. ClimKern has a single function that produces both feedbacks simultaneously called ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SJnUkvA0g0"},{"type":"link","url":"https://tyfolino.github.io/climkern/climkern.html#climkern.calc_T_feedbacks","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"calc_T_feedbacks()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RSJ0mT6yhG"}],"urlSource":"https://tyfolino.github.io/climkern/climkern.html#climkern.calc_T_feedbacks","key":"PrkU8rsHed"},{"type":"text","value":". The variables we need this time are:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CZwWXN7Xra"}],"key":"jnSV3LdAdy"},{"type":"table","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Variable name","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"f2ikvSEvoU"}],"key":"UYyaO1m2fi"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Description","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QxFFqtYF4u"}],"key":"g47JODQtRh"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Units","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"txabNiHeAp"}],"key":"Fui48QYcvh"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SMbQdt0ov7"}],"key":"yKxq8yLcD2"}],"key":"N5E6iAjxtX"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"emphasis","children":[{"type":"text","value":"ta","key":"n1Y3jFP342"}],"key":"iIxR0Hu9AB"}],"key":"QONHC7Fs0w"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The 4-dimensional air temperature","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZzUJLWxZsc"}],"key":"OA8cgdaMVB"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"K","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pXNEf6Lf1s"}],"key":"BGVcJ18Igm"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[],"key":"BYiiPhkeyA"}],"key":"hg2gVaekQ7"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"emphasis","children":[{"type":"text","value":"ts","key":"eXQkin7AiM"}],"key":"s60fHnrggH"}],"key":"QZGUjjOsIX"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The 3-dimensional surface skin temperature","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"EcHFM8kugA"}],"key":"eUqSP996LH"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"K","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"NOPFOopEIW"}],"key":"RKGMSGIZSD"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[],"key":"hkJHqxAgbO"}],"key":"us1A13r2Vd"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"emphasis","children":[{"type":"text","value":"ps","key":"oNsTI22iJe"}],"key":"cFVi0pvabd"}],"key":"FKRD6OxbsS"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The 3-dimensional surface pressure","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"qth1h7jBIP"}],"key":"ivlqOrJUAQ"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Pa, mb, or hPa","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"pO0QTg9l00"}],"key":"eFOCwBPH8r"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[],"key":"nEs0mcZ6nl"}],"key":"HFStvOw1zM"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"emphasis","children":[{"type":"text","value":"trop_p","key":"IChZE9hWTA"}],"key":"hfLrCSBLCJ"}],"key":"BlxaENfRR6"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"The 3-dimensional tropopause height","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"T4MB7HkXro"}],"key":"QVpsOREHmS"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Pa, mb, or hPa","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"r3Xr8DmOhi"}],"key":"VMEdotBT0N"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"emphasis","children":[{"type":"text","value":"Optional","key":"iR0dFVPWyr"}],"key":"DTV94AFfu0"}],"key":"fwdPRy3jii"}],"key":"Tm0aJh2oBs"}],"key":"JjeWIPDQDo"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"CMIP6 output rarely contains the tropopause height, so we will create a default tropopause that decreases linearly with the cosine of latitude from 100 hPa at the Equator to 300 hPa at the poles.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"CDDnPc1S7X"}],"key":"iaABx32tpy"}],"key":"pKpc1iTqFg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Use ClimKern's \"hidden\" make_tropo function\npert[\"trop_p\"] = ck.util.make_tropo(pert.ps)\npert.trop_p.attrs[\"units\"] = \"Pa\"\n\nlr,pl = ck.calc_T_feedbacks(\n    ctrl.ta,ctrl.ts,ctrl.ps,pert.ta,pert.ts,pert.ps,pert_trop=pert.trop_p,kern=\"ERA5\"\n)","key":"XpBM2Q5SGc"},{"type":"output","id":"btus8a0rEzY3GWocHI4aW","data":[],"key":"DHC4kqMmvZ"}],"key":"z8fe3AsCJI"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Simple. Let’s see what it looks like.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G9djoRwqWo"}],"key":"qZmbV0jdNg"}],"key":"wQbz0W1v0h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create the base map\nfig, ax = base_map()\n\n# Plot the surface albedo feedback \nlr.mean(dim=\"time\").plot(ax=ax, **plotargs)\n\n# Add a title\nax.set_title(\"Time-averaged Lapse Rate Feedback\");","key":"VXeTStSqD9"},{"type":"output","id":"sgF4VdancnHHFPvjRBWWs","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"b1bca7c41dad2b96a67a2230f4962f88","path":"/radiative-feedback-cookbook/build/b1bca7c41dad2b96a67a2230f4962f88.png"}}}],"key":"H3d0WMV86G"}],"key":"dg2EQyTz3N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create the base map\nfig, ax = base_map()\n\n# Plot surface albedo feedback\n(lr.mean(dim=\"time\")/Δts.mean(dim=\"time\")).plot(ax=ax, **plotargs_2)\n\n# Add a title\nax.set_title(\"Time-averaged Lapse Rate Feedback\");","key":"G518OhNnga"},{"type":"output","id":"yc2lHvMr9RRpkpR_XKVlU","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"c23fe85703792f4cae1893a83bbda153","path":"/radiative-feedback-cookbook/build/c23fe85703792f4cae1893a83bbda153.png"}}}],"key":"eboV3H6ufR"}],"key":"exgEFXycQg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create the base map\nfig, ax = base_map()\n\n# Plot surface albedo feedback\npl.mean(dim=\"time\").plot(ax=ax, cmap=\"Blues_r\", **plotargs)\n\n# Add a title\nax.set_title(\"Time-averaged Planck Feedback\");","key":"HoNLJ9CFrI"},{"type":"output","id":"4jhRbEQf6QS6stbhRDFI6","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"766fb39e268ce8a167bc40f9e55001d1","path":"/radiative-feedback-cookbook/build/766fb39e268ce8a167bc40f9e55001d1.png"}}}],"key":"uBRhwgyJ1i"}],"key":"P19WHytxuE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create the base map\nfig, ax = base_map()\n\n# Plot surface albedo feedback\n(pl.mean(dim=\"time\")/Δts.mean(dim=\"time\")).plot(ax=ax,cmap=\"Blues_r\", **plotargs_2)\n\n# Add a title\nax.set_title(\"Time-averaged Planck Feedback\");","key":"XeG0Oxkqqm"},{"type":"output","id":"HNY72Q2Z-0NJoEE-wD0jP","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"00fd5e2de358c4012f44dddb899e25c9","path":"/radiative-feedback-cookbook/build/00fd5e2de358c4012f44dddb899e25c9.png"}}}],"key":"DfgBlrL2q3"}],"key":"onn3KfZIIv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"These results seem reasonable. The Planck feedback is often the feedback with the largest magnitude and scales nonlinearly with temperature change. The lapse rate feedback changes sign depending on the vertical structure of the atmosphere is usually positive (warming) at the poles and negative (cooling) in the tropics.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L1Zohpr14C"}],"key":"GnXxzlIKGI"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s get those global averages again!","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VCsYaSCaqE"}],"key":"aIUuVcDnya"}],"key":"g5HmTyd8yZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Output the time-averaged global temperature feedbacks\noutput = (\"The global average lapse rate and Planck feedbacks are\"+\n          \" {lr:.2f} and {pl:.2f} W/m\\u00b2/K, respectively.\")\nprint(output.format(lr=float(ck.spat_avg((lr.mean(dim=\"time\")/Δts.mean(dim=\"time\")\n                                         ).expand_dims(\"time\"))),\n                   pl=float(ck.spat_avg((pl.mean(dim=\"time\")/Δts.mean(dim=\"time\")\n                                        ).expand_dims(\"time\")))))","key":"Fd5p7HD2B6"},{"type":"output","id":"de-R-H9E92AF6ztej91CR","data":[{"output_type":"stream","name":"stdout","text":"The global average lapse rate and Planck feedbacks are -0.78 and -3.33 W/m²/K, respectively.\n"}],"key":"iQ3MW5TdeB"}],"key":"xZk2Mn1it2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Water vapor feedbacks","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vE1WRkQKu9"}],"identifier":"water-vapor-feedbacks","label":"Water vapor feedbacks","html_id":"water-vapor-feedbacks","implicit":true,"key":"J5kxzKgMZx"}],"key":"wDRJWLbHX4"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we use ClimKern to calculate the longwave and shortwave water vapor feedabcks. ClimKern has a single function that produces both called ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ESnJDtFX6R"},{"type":"link","url":"https://tyfolino.github.io/climkern/climkern.html#climkern.calc_q_feedbacks","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"calc_q_feedbacks()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gs1whml0JM"}],"urlSource":"https://tyfolino.github.io/climkern/climkern.html#climkern.calc_q_feedbacks","key":"yhkf4cDuqd"},{"type":"text","value":". This function requires both the specific humidity and air temperature because ClimKern has to normalize the water vapor kernels to make them compatible with the specific humidity.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DUATx26tsX"}],"key":"B5Em3cx2yg"},{"type":"table","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Variable name","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"x0BU4tm6wE"}],"key":"CWGetbkAea"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Description","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fwFbK5Of0S"}],"key":"KJdedagVfI"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Units","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dQawKMp7W4"}],"key":"P8mmzv3kL2"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jBLZ1j8aPd"}],"key":"zchYn2ElAJ"}],"key":"o0B7kHYH6S"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"emphasis","children":[{"type":"text","value":"hus","key":"ITT0AzRGYv"}],"key":"OjXyJTlt6I"}],"key":"rjPTEs1FRu"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The 4-dimensional specific humidity","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jLHlcysvvA"}],"key":"D6B9MCTbIy"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineMath","value":"\\frac{g}{g}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmfrac\u003e\u003cmi\u003eg\u003c/mi\u003e\u003cmi\u003eg\u003c/mi\u003e\u003c/mfrac\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\frac{g}{g}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.2286em;vertical-align:-0.4811em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7475em;\"\u003e\u003cspan style=\"top:-2.655em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003eg\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.4461em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003eg\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.4811em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"E4HUQjJUDK"},{"type":"text","value":" or ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Zcc7RUlQKI"},{"type":"inlineMath","value":"\\frac{g}{kg}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmfrac\u003e\u003cmi\u003eg\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003ek\u003c/mi\u003e\u003cmi\u003eg\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\frac{g}{kg}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.2286em;vertical-align:-0.4811em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7475em;\"\u003e\u003cspan style=\"top:-2.655em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003eg\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.4461em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003eg\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.4811em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"yFef1chxnC"}],"key":"R23N7ZGmIS"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[],"key":"EFCzKcLWqn"}],"key":"EaXWd9Sh0b"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"emphasis","children":[{"type":"text","value":"ta","key":"tZVTB2iEcQ"}],"key":"i6lYxqvmjJ"}],"key":"zNUsg3x7wQ"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The 4-dimensional air temperature","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"zfuwI0Avhe"}],"key":"sM15EMMdYx"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"K","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"RIlL82roQJ"}],"key":"JqCe4rYpjU"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[],"key":"J7DYHS0cM4"}],"key":"TVC8i0MjD6"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"emphasis","children":[{"type":"text","value":"ps","key":"UK9ykoo1GH"}],"key":"lGQt7IK2SR"}],"key":"dVvKw8M65A"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The 3-dimensional surface pressure","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"fssBBmRWGP"}],"key":"Smw0oGLmhf"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Pa, mb, or hPa","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"uyHMubOF5v"}],"key":"SCLIObWe6E"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[],"key":"T48GSsNhks"}],"key":"yd05JCcelc"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"emphasis","children":[{"type":"text","value":"trop_p","key":"BMoFSYUuli"}],"key":"VMQfu1Op86"}],"key":"QCWlyANDmD"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"The 3-dimensional tropopause height","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"UinwIpV5or"}],"key":"hG0MOWH5SX"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Pa, mb, or hPa","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"etbc6fB69a"}],"key":"mfJV7FcJvA"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"emphasis","children":[{"type":"text","value":"Optional","key":"VT6h7i2QBv"}],"key":"VxNDPPTQK3"}],"key":"PwWkSgAJ3I"}],"key":"lE0uQWKVVN"}],"key":"kzOtwYb2km"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"There is one more argument we can provide called ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"jTLdcA8MeR"},{"type":"inlineCode","value":"method","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"sPqYAYCozE"},{"type":"text","value":", which is simply a number 1-4. This corresponds to whether to use a fractional approximation for logarithms, use the logarithms explicitly, or use the linear change in water vapor concentration. See the discussion in Section 3.2 of ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"jVPeoiAJp5"},{"type":"citeGroup","kind":"narrative","children":[{"type":"cite","kind":"narrative","label":"Janoski:2025a","identifier":"janoski:2025a","children":[{"type":"text","value":"Janoski ","key":"V9bKt4w7rz"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"A9s0tAdsWR"}],"key":"n5n5hK468p"},{"type":"text","value":" (2025)","key":"ZjDgunjGa3"}],"enumerator":"1","key":"o84sfNoOa7"}],"key":"l6QoD19aHM"},{"type":"text","value":", and see ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"rgUfnkQ0QW"},{"type":"link","url":"https://tyfolino.github.io/climkern/climkern.html#climkern.calc_q_feedbacks","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"here in the climkern docs","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"PP6rzc1TWJ"}],"urlSource":"https://tyfolino.github.io/climkern/climkern.html#climkern.calc_q_feedbacks","key":"YAKQFE8A2M"},{"type":"text","value":" for how these are implemented.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"IpDGL2kTBe"}],"key":"zQRFxN8Eev"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"We will use ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"QmHi0DULRA"},{"type":"inlineCode","value":"method=1","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"fYXKawaB3s"},{"type":"text","value":" which is to use the natural logarithm of specific humidity without doing a fractional approximation.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"jGd5rvBTIi"}],"key":"MYoQJU0E4W"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"We will use the same tropopause height as before.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"H2Rpdz7zMv"}],"key":"UiqUK6cXzf"}],"key":"iAa4QtKo0I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Use ClimKern's water vapor feedback function\nqlw,qsw = ck.calc_q_feedbacks(\n    ctrl.hus,ctrl.ta,ctrl.ps,pert.hus,pert.ps,pert_trop=pert.trop_p,kern=\"ERA5\",\n    method=1\n)","key":"BXuEtPS8du"},{"type":"output","id":"fLQxweqqQg_HZbwdQLeg_","data":[],"key":"zhHrm4UYPd"}],"key":"RmfuV06A6e"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s take a look, starting with the longwave.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ehERavQImz"}],"key":"peeQniUlFW"}],"key":"E25oDJjE8h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create the base map\nfig, ax = base_map()\n\n# Plot the longwave water vapor feedback\nqlw.mean(dim=\"time\").plot(ax=ax,cmap=\"Reds\", **plotargs)\n\n# Add a title\nax.set_title(\"Time-averaged LW Water Vapor Feedback\");","key":"CxDeXJsLdW"},{"type":"output","id":"vRoyT4e0FLhbRBKrTP349","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"835c5e9bb6223bd7dc8f998529714790","path":"/radiative-feedback-cookbook/build/835c5e9bb6223bd7dc8f998529714790.png"}}}],"key":"XHjXlPAqXO"}],"key":"FzmotykS74"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create the base map\nfig, ax = base_map()\n\n# Plot the longwave water vapor feedback \n(qlw.mean(dim=\"time\")/Δts.mean(dim=\"time\")).plot(ax=ax,cmap=\"Reds\", **plotargs_2)\nax.coastlines()\n\n# Add a title\nax.set_title(\"Time-averaged LW Water Vapor Feedback\");","key":"f8tVXxPrQv"},{"type":"output","id":"Jr5Q00hT4rohCfcaEH4yq","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1971279117058e39a643ad753a2e091b","path":"/radiative-feedback-cookbook/build/1971279117058e39a643ad753a2e091b.png"}}}],"key":"X7jq1hWLdO"}],"key":"ktFyJRskqA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And now the shortwave...","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QBQdaX7TZg"}],"key":"e9gYF8bEwi"}],"key":"AU0lt3nZaU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create the base map\nfig, ax = base_map()\n\n# Plot the longwave water vapor feedback and add coastlines\nqsw.mean(dim=\"time\").plot(ax=ax,cmap=\"Reds\", **plotargs)\n\n\n# Add a title\nax.set_title(\"Time-averaged SW Water Vapor Feedback\");","key":"EuJee581Xe"},{"type":"output","id":"7xoYQVH9voCOU2p0xZH8s","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"bc190dfeade6ce7b977ecee7d2cb2146","path":"/radiative-feedback-cookbook/build/bc190dfeade6ce7b977ecee7d2cb2146.png"}}}],"key":"rbvjqjZsY0"}],"key":"T3drg4Klsn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create the base map\nfig, ax = base_map()\n\n# Plot the longwave water vapor feedback and add coastlines\n(qsw.mean(dim=\"time\")/Δts.mean(dim=\"time\")).plot(ax=ax,cmap=\"Reds\", **plotargs_2)\n\n# Add a title\nax.set_title(\"Time-averaged SW Water Vapor Feedback\");","key":"v1Gn9pv8lq"},{"type":"output","id":"7zyhSLUM8aw27rQ-6X8yn","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"725135775721a81529c230b68266a5d9","path":"/radiative-feedback-cookbook/build/725135775721a81529c230b68266a5d9.png"}}}],"key":"k0FRUqMuaK"}],"key":"lI6OgGDSC2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Output the time-averaged global surface albedo feedback\noutput = (\"The global average longwave and shortwave water vapor feedbacks are\"+\n          \" {lw:.2f} and {sw:.2f} W/m\\u00b2/K, respectively.\")\nprint(output.format(lw=float(ck.spat_avg((qlw.mean(dim=\"time\")/Δts.mean(dim=\"time\")\n                                         ).expand_dims(\"time\"))),\n                   sw=float(ck.spat_avg((qsw.mean(dim=\"time\")/Δts.mean(dim=\"time\")\n                                        ).expand_dims(\"time\")))))","key":"cFEQ5neP3S"},{"type":"output","id":"9xm5ATluNFCzzxPzY2Ft2","data":[{"output_type":"stream","name":"stdout","text":"The global average longwave and shortwave water vapor feedbacks are 1.59 and 0.19 W/m²/K, respectively.\n"}],"key":"gKzhoIBz8b"}],"key":"ByCrgmHgCc"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cloud feedbacks","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fc6B8vivuX"}],"identifier":"cloud-feedbacks","label":"Cloud feedbacks","html_id":"cloud-feedbacks","implicit":true,"key":"aQuUBD6HX7"}],"key":"CM70KCpgKC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Download radiative forcing","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TSaddpSYLY"}],"identifier":"download-radiative-forcing","label":"Download radiative forcing","html_id":"download-radiative-forcing","implicit":true,"key":"XW64XrMREm"}],"key":"lu2mZ0e72U"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"It’s time for cloud feedbacks. However, like anything to do with clouds, there are some complications. You ideally need the effective radiative forcing (ERF), which is a measure of radiative imbalance imposed by CO","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xgQgxBfZ5z"},{"type":"inlineMath","value":"_2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmrow\u003e\u003c/mrow\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e_2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4511em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"SHHK9D7gdW"},{"type":"text","value":" in the absence of surface temperature change ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iMyANqDMWZ"},{"type":"cite","url":"https://doi.org/10.5194/acp-20-9591-2020","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Smith et al., 2020","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z6HqGiyo78"}],"kind":"narrative","label":"Smith_2020","identifier":"https://doi.org/10.5194/acp-20-9591-2020","enumerator":"2","key":"rNvqIFH1Dk"},{"type":"text","value":". Thankfully, CESM2 radiative forcing for our scenarios is available on the Google cloud.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nU2INC9SR4"}],"key":"pXIVpu1c52"}],"key":"ybb6xXMWEM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Specify data location, open it\ncat_url = \"https://storage.googleapis.com/cmip6/pangeo-cmip6.json\"\ncol = intake.open_esm_datastore(cat_url)\n\n# # Create a catalog of matching simulations\ncat = col.search(activity_id=\"RFMIP\",source_id=\"CESM2\",experiment_id=[\"piClim-4xCO2\",\n                                                                      \"piClim-control\"],\n                variable_id=[\"rlut\",\"rsut\",\"rsdt\"])\n\n# Convert to a dictionary of Xarray Datasets\nds_dict = cat.to_dataset_dict(zarr_kwargs={'consolidated': True})\n\n# Assign Datasets to variables\nrf_ctrl = ds_dict[\"RFMIP.NCAR.CESM2.piClim-control.Amon.gn\"]\nrf_pert = ds_dict[\"RFMIP.NCAR.CESM2.piClim-4xCO2.Amon.gn\"]","key":"lyhgVDeT8l"},{"type":"output","id":"kutYZpp0QqpiWFZtVRwju","data":[{"output_type":"stream","name":"stdout","text":"\n--\u003e The keys in the returned dictionary of datasets are constructed as follows:\n\t'activity_id.institution_id.source_id.experiment_id.table_id.grid_label'\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cIPython.core.display.HTML object\u003e","content_type":"text/plain"},"text/html":{"content":"\n\u003cstyle\u003e\n    /* Turns off some styling */\n    progress {\n        /* gets rid of default border in Firefox and Opera. */\n        border: none;\n        /* Needs to be in here for Safari polyfill so background images work as expected. */\n        background-size: auto;\n    }\n    progress:not([value]), progress:not([value])::-webkit-progress-bar {\n        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);\n    }\n    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {\n        background: #F44336;\n    }\n\u003c/style\u003e\n","content_type":"text/html"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cIPython.core.display.HTML object\u003e","content_type":"text/plain"},"text/html":{"content":"\n    \u003cdiv\u003e\n      \u003cprogress value='0' class='' max='2' style='width:300px; height:20px; vertical-align: middle;'\u003e\u003c/progress\u003e\n      \n    \u003c/div\u003e\n    ","content_type":"text/html"}}}],"key":"dR7xCpgT6h"}],"key":"EUrGaOVKKX"},{"type":"block","kind":"notebook-content","children":[{"type":"div","class":"admonition alert alert-info","children":[{"type":"paragraph","children":[{"type":"text","value":"Info","key":"R800aaQmkS"}],"key":"aJP1nadge1"},{"type":"text","value":"Your relevant information here!","key":"c6lBgaf5bP"}],"key":"L6gHUJCqwD"}],"key":"mMIcA7xv2I"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Feel free to copy this around and edit or play around with yourself. Some other ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JrsUkwh7iG"},{"type":"inlineCode","value":"admonitions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Tiube4Ggnf"},{"type":"text","value":" you can put in:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LQlLjvQsv6"}],"key":"q2n6Kgkee2"}],"key":"CRCR1zV8KJ"},{"type":"block","kind":"notebook-content","children":[{"type":"div","class":"admonition alert alert-success","children":[{"type":"paragraph","children":[{"type":"text","value":"Success","key":"OIuTlkf5yg"}],"key":"PU5uhuTRVR"},{"type":"text","value":"We got this done after all!","key":"QpftSkDxsa"}],"key":"D9j6KYwVtZ"}],"key":"jLRfgDbl8Z"},{"type":"block","kind":"notebook-content","children":[{"type":"div","class":"admonition alert alert-warning","children":[{"type":"paragraph","children":[{"type":"text","value":"Warning","key":"OEMZKPnhZz"}],"key":"lkK5bAOMDY"},{"type":"text","value":"Be careful!","key":"wgJcNAJP8W"}],"key":"MKEsoI2YSE"}],"key":"O7EHHqy8Ve"},{"type":"block","kind":"notebook-content","children":[{"type":"div","class":"admonition alert alert-danger","children":[{"type":"paragraph","children":[{"type":"text","value":"Danger","key":"DHPXmeffYo"}],"key":"D9oCVoEjgm"},{"type":"text","value":"Scary stuff be here.","key":"K37hxoLii1"}],"key":"dwFw4grQ82"}],"key":"ZHWGXcv2ZH"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We also suggest checking out Jupyter Book’s ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uNPzEMjPCz"},{"type":"link","url":"https://jupyterbook.org/content/metadata.html#jupyter-cell-tags","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"brief demonstration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"E3SLjxG6pz"}],"urlSource":"https://jupyterbook.org/content/metadata.html#jupyter-cell-tags","key":"LD9TiWLsy0"},{"type":"text","value":" on adding cell tags to your cells in Jupyter Notebook, Lab, or manually. Using these cell tags can allow you to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"scPBWkwlVL"},{"type":"link","url":"https://jupyterbook.org/interactive/hiding.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"customize","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fd1Ce6pp1S"}],"urlSource":"https://jupyterbook.org/interactive/hiding.html","key":"AOAjnDI3GC"},{"type":"text","value":" how your code content is displayed and even ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AE3PRRq3Nk"},{"type":"link","url":"https://jupyterbook.org/content/execute.html#dealing-with-code-that-raises-errors","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"demonstrate errors","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yFYTdr5vfM"}],"urlSource":"https://jupyterbook.org/content/execute.html#dealing-with-code-that-raises-errors","key":"FLVIschtR6"},{"type":"text","value":" without altogether crashing our loyal army of machines!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y78D0rI36e"}],"key":"Vq7FhV5k0q"}],"key":"lH1M6KiW0o"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Lnz4HWd18c"}],"key":"kYRaxM7xKk"}],"key":"wjU6e2kxn3"},"references":{"cite":{"order":["Janoski:2025a","Smith_2020"],"data":{"Janoski:2025a":{"label":"Janoski:2025a","enumerator":"1","doi":"10.5194/gmd-18-3065-2025","html":"Janoski, T. P., Mitevski, I., Kramer, R. J., Previdi, M., \u0026 Polvani, L. M. (2025). ClimKern v1.2: a new Python package and kernel repository for calculating radiative feedbacks. \u003ci\u003eGeoscientific Model Development\u003c/i\u003e, \u003ci\u003e18\u003c/i\u003e(10), 3065–3079. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.5194/gmd-18-3065-2025\"\u003e10.5194/gmd-18-3065-2025\u003c/a\u003e","url":"https://doi.org/10.5194/gmd-18-3065-2025"},"Smith_2020":{"label":"Smith_2020","enumerator":"2","doi":"10.5194/acp-20-9591-2020","html":"Smith, C. J., Kramer, R. J., Myhre, G., Alterskjær, K., Collins, W., Sima, A., Boucher, O., Dufresne, J.-L., Nabat, P., Michou, M., Yukimoto, S., Cole, J., Paynter, D., Shiogama, H., O’Connor, F. M., Robertson, E., Wiltshire, A., Andrews, T., Hannay, C., … Forster, P. M. (2020). Effective radiative forcing and adjustments in CMIP6 models. \u003ci\u003eAtmospheric Chemistry and Physics\u003c/i\u003e, \u003ci\u003e20\u003c/i\u003e(16), 9591–9618. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.5194/acp-20-9591-2020\"\u003e10.5194/acp-20-9591-2020\u003c/a\u003e","url":"https://doi.org/10.5194/acp-20-9591-2020"}}}},"footer":{"navigation":{"prev":{"title":"Feedback analysis using radiative kernels","url":"/notebooks/foundations/manual-calc","group":"Foundations"}}},"domain":"http://localhost:3000"},"project":{"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"bibliography":["/home/runner/work/radiative-feedback-cookbook/radiative-feedback-cookbook/bibliography.bib"],"title":"Radiative Feedback Cookbook","authors":[{"nameParsed":{"literal":"Project Pythia Community","given":"Project Pythia","family":"Community"},"name":"Project Pythia Community","url":"https://projectpythia.org/","id":"contributors-myst-generated-uid-0"}],"contributors":[{"id":"brian-rose","nameParsed":{"literal":"Brian E. J. Rose","given":"Brian E. J.","family":"Rose"},"name":"Brian E. J. Rose","orcid":"0000-0002-9961-3821","email":"brose@albany.edu","affiliations":["UAlbany"],"url":"https://brian-rose.github.io","github":"brian-rose","bluesky":"@brianejrose.bsky.social","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"},{"id":"clyne","nameParsed":{"literal":"John Clyne","given":"John","family":"Clyne"},"name":"John Clyne","orcid":"0000-0003-2788-9017","affiliations":["CISL"],"github":"clyne"},{"id":"jukent","nameParsed":{"literal":"Julia Kent","given":"Julia","family":"Kent"},"name":"Julia Kent","orcid":"0000-0002-5611-8986","affiliations":["CISL"],"github":"jukent"},{"id":"ktyle","nameParsed":{"literal":"Kevin Tyle","given":"Kevin","family":"Tyle"},"name":"Kevin Tyle","orcid":"0000-0001-5249-9665","affiliations":["UAlbany"],"github":"ktyle"},{"id":"andersy005","nameParsed":{"literal":"Anderson Banihirwe","given":"Anderson","family":"Banihirwe"},"name":"Anderson Banihirwe","orcid":"0000-0001-6583-571X","affiliations":["CarbonPlan"],"github":"andersy005"},{"id":"dcamron","nameParsed":{"literal":"Drew Camron","given":"Drew","family":"Camron"},"name":"Drew Camron","orcid":"0000-0001-7246-6502","affiliations":["Unidata"],"github":"dcamron"},{"id":"dopplershift","nameParsed":{"literal":"Ryan May","given":"Ryan","family":"May"},"name":"Ryan May","orcid":"0000-0003-2907-038X","affiliations":["Unidata"],"github":"dopplershift"},{"id":"mgrover1","nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","affiliations":["Argonne"],"github":"mgrover1"},{"id":"r-ford","nameParsed":{"literal":"Robert R. Ford","given":"Robert R.","family":"Ford"},"name":"Robert R. Ford","orcid":"0000-0001-5483-4965","affiliations":["UAlbany"],"github":"r-ford"},{"id":"kmpaul","nameParsed":{"literal":"Kevin Paul","given":"Kevin","family":"Paul"},"name":"Kevin Paul","orcid":"0000-0001-8155-8038","affiliations":["NVIDIA"],"github":"kmpaul"},{"id":"jnmorley","nameParsed":{"literal":"James Morley","given":"James","family":"Morley"},"name":"James Morley","orcid":"0009-0005-5193-7981","github":"jnmorley"},{"id":"erogluorhan","nameParsed":{"literal":"Orhan Eroglu","given":"Orhan","family":"Eroglu"},"name":"Orhan Eroglu","orcid":"0000-0003-3099-8775","affiliations":["CISL"],"github":"erogluorhan"},{"id":"lkailynncar","nameParsed":{"literal":"Lily Kailyn","given":"Lily","family":"Kailyn"},"name":"Lily Kailyn","orcid":"0009-0002-0125-5091","affiliations":["CISL"],"github":"lkailynncar"},{"id":"anissa111","nameParsed":{"literal":"Anissa Zacharias","given":"Anissa","family":"Zacharias"},"name":"Anissa Zacharias","orcid":"0000-0002-2666-8493","affiliations":["CISL"],"github":"anissa111"},{"id":"kafitzgerald","nameParsed":{"literal":"Katelyn FitzGerald","given":"Katelyn","family":"FitzGerald"},"name":"Katelyn FitzGerald","orcid":"0000-0003-4184-1917","affiliations":["CISL"],"github":"kafitzgerald"}],"github":"https://github.com/projectpythia/radiative-feedback-cookbook","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"copyright":"2024","references":{"foundations":{"url":"https://foundations.projectpythia.org"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://binder.projectpythia.org","provider":"github","repo":"projectpythia/radiative-feedback-cookbook","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"children":[{"file":"notebooks/foundations/energy-balance-model.ipynb"},{"file":"notebooks/foundations/manual-calc.ipynb"},{"file":"notebooks/foundations/climkern-calc.ipynb"}],"title":"Foundations"},{"children":[{"file":"references.md"}],"title":"Appendix"}],"thumbnail":"/radiative-feedback-cookbook/build/thumbnail-eac97f75cbeed83eb0ac174729026583.png","exports":[],"index":"index","pages":[{"level":1,"title":"Preamble"},{"slug":"notebooks.how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/radiative-feedback-cookbook/build/undefined","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Foundations"},{"slug":"notebooks.foundations.energy-balance-model","title":"Energy Balance Model and Feedbacks","description":"","date":"","thumbnail":"/radiative-feedback-cookbook/build/ProjectPythia_Logo_F-6ffb048ae19a63b323c6c8d8a8c9e365.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.foundations.manual-calc","title":"Feedback analysis using radiative kernels","description":"","date":"","thumbnail":"/radiative-feedback-cookbook/build/ProjectPythia_Logo_F-6ffb048ae19a63b323c6c8d8a8c9e365.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.foundations.climkern-calc","title":"Feedbacks with ClimKern","description":"","date":"","thumbnail":"/radiative-feedback-cookbook/build/ClimKern-logo-a20c73e644259e4ef5ac632daf3ae05d.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Appendix"}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/radiative-feedback-cookbook/build/manifest-B2B2E6A5.js";
import * as route0 from "/radiative-feedback-cookbook/build/root-IB5726YR.js";
import * as route1 from "/radiative-feedback-cookbook/build/routes/$-LXLHKVOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/radiative-feedback-cookbook/build/entry.client-UNPC4GT3.js");</script></body></html>